import{d as S,q as V,u as j,x as F,o as A,c as a,e as r,a as e,b as w,y as B,F as l,r as m,t as c,z as N,l as k,v as D,H as O,h as $,w as L,D as R,T as E}from"./app-5oWDxCZy.js";import{a as H,_ as P}from"./TabButton.vue_vue_type_script_setup_true_lang-Jb8kqSNr.js";import{s as Q}from"./index-AoBzFk-n.js";import{T as M}from"./TransportListRepo-BuCElTHf.js";import{C as U}from"./ChangeRepo-DHA6uW9J.js";import{O as G}from"./OrganizationRepo-DO3TcAMZ.js";import"./PrimeInputs-ALQIxP-D.js";import"./index-csHk8Oer.js";import"./index-Bxi1OH47.js";import"./index.esm-C88Gxk8I.js";const J={class:"flex w-full"},K={class:"p-8 flex-grow bg-white border border-gray-100 rounded-4xl min-h-154 shadow-xs"},W={key:0,class:"flex items-center justify-center h-full"},X={key:1,class:"flex items-center justify-center h-full"},Y={key:2},Z={class:"w-full table-fixed"},I={class:"border-b-2 border-black"},ee={class:"border border-gray-200 py-1 px-3 align-top w-84"},te=["rowspan"],re=["rowspan"],ae={class:"border border-gray-200 py-0.5 px-3 align-top text-center"},se={class:"border border-gray-200 py-0.5 px-3 align-top text-sm"},oe={class:"border border-gray-200 py-0.5 px-3 align-top text-center"},ne=S({__name:"ActiveTableTab",props:{transport_type:{}},setup(T){const g=T,d=V([]),{execute:f,data:y,isFirstLoading:z}=j(U.index);function u(i,t,n){const s=i.find(o=>o.lavozim_id===t&&o.change_id===n);return s?s.employe:null}const p=F(()=>d.value.reduce((i,t)=>i+t.transports.length,0));function b(i){var n;return(n=y.value)==null||n.find(s=>s.id==5974523),Array.from(new Set(Object.values(i))).sort((s,o)=>s-o).map(s=>{var o;return(o=y.value)==null?void 0:o.find(_=>_.id==s)})}return A(async()=>{const{data:i}=await M.tableTransportType(g.transport_type.id);await f(),d.value=i,console.log(d.value)}),(i,t)=>{const n=Q;return r(),a("section",J,[e("aside",K,[w(z)?(r(),a("main",W,[B(n)])):p.value==0?(r(),a("main",X,t[0]||(t[0]=[e("div",{class:"w-120 text-center"},[e("h3",{class:"text-gray-800 text-2xl mb-1 font-semibold"},"Qurilmalar kiritilmagan"),e("p",{class:"text-gray-500"}," Hozirda ushbu transport turiga hech qanday qurilma kiritilmagan. Iltimos, avval transport turlariga mos qurilmalarni qo'shing. ")],-1)]))):(r(),a("main",Y,[e("table",Z,[e("thead",null,[e("tr",I,[t[2]||(t[2]=e("td",{class:"border border-gray-200 py-1 px-3 w-36 align-top"},"Qurilma modeli",-1)),t[3]||(t[3]=e("td",{class:"border border-gray-200 py-1 px-3 w-11 align-top"},"â„–",-1)),t[4]||(t[4]=e("td",{class:"border border-gray-200 py-1 px-3 w-11 align-top text-center"},[e("i",{class:"pi pi-sun"})],-1)),(r(!0),a(l,null,m(i.transport_type.lavozims,s=>(r(),a(l,null,[e("td",ee,c(s.name),1),t[1]||(t[1]=e("td",{class:"border border-gray-200 py-1 px-3 align-top w-9 text-center"},[e("i",{class:"pi pi-circle-fill text-xs!"})],-1))],64))),256)),t[5]||(t[5]=e("td",{class:"border border-gray-200 py-1 px-3 align-top"},null,-1))])]),e("tbody",null,[(r(!0),a(l,null,m(d.value,s=>(r(),a(l,{key:s.id},[(r(!0),a(l,null,m(s.transports,(o,_)=>(r(),a(l,{key:o.id},[(r(!0),a(l,null,m(b(o.smena.formula.first),(C,x)=>(r(),a("tr",{key:o.id+"-"+x,class:N({"border-b-2 border-black":_===s.transports.length-1&&x===b(o.smena.formula.first).length-1})},[_===0&&x===0?(r(),a("td",{key:0,rowspan:s.transports.reduce((h,v)=>h+b(v.smena.formula.first).length,0),class:"border border-gray-200 py-0.5 px-3 align-top"},c(s.name),9,te)):k("",!0),x===0?(r(),a("td",{key:1,rowspan:b(o.smena.formula.first).length,class:"border border-gray-200 py-0.5 px-3 align-top"},c(o.garage_number),9,re)):k("",!0),e("td",ae,c(C.name),1),(r(!0),a(l,null,m(i.transport_type.lavozims,h=>{var v,q;return r(),a(l,null,[e("td",se,c((v=u(o.groups,h.id,C.id))==null?void 0:v.name),1),e("td",oe,c((q=u(o.groups,h.id,C.id))==null?void 0:q.razryad),1)],64)}),256)),t[6]||(t[6]=e("td",{class:"border border-gray-200 py-0.5 px-3 align-top"},null,-1))],2))),128))],64))),128))],64))),128))])])]))])])}}}),ie={key:0,name:"tabs",class:"flex flex-col p-5"},le={class:"flex gap-0.5 relative z-10 pl-11 justify-between items-end"},de={class:"relative"},he=S({__name:"TablePage",props:["id"],setup(T){const g=T,d=V(null),f=D(),{execute:y,isLoading:z,data:u}=j(G.transports);return O(()=>g.id,p=>y({id:p})),A(async()=>{var p;f.isAdmin?await y({id:g.id}):await y({id:(p=f.user)==null?void 0:p.organization_id}),u.value&&u.value.transport_types[0]&&(d.value=u.value.transport_types[0].id)}),(p,b)=>{var i,t;return w(z)?k("",!0):(r(),a("section",ie,[e("nav",le,[e("main",null,[(r(!0),a(l,null,m((i=w(u))==null?void 0:i.transport_types,n=>(r(),$(P,{class:"text-xl!",active:d.value==n.id,onClick:s=>d.value=n.id},{default:L(()=>[R(c(n.name),1)]),_:2},1032,["active","onClick"]))),256))]),B(H,{id:g.id},null,8,["id"])]),e("main",de,[(r(!0),a(l,null,m((t=w(u))==null?void 0:t.transport_types,n=>(r(),$(E,{name:"fade",mode:"out-in"},{default:L(()=>[n.id===d.value?(r(),$(ne,{key:n.id,transport_type:n},null,8,["transport_type"])):k("",!0)]),_:2},1024))),256))])]))}}});export{he as default};
