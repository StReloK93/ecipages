import{i as Q,B as W,s as X,j as Y,k as Z,c as n,l as C,e as t,m as K,h as k,n as S,p as F,t as T,q as z,d as L,v as D,x as ee,u as O,o as P,a as l,F as b,r as x,y as U,b as R,z as q,A as te,_ as re,w as N,C as G,D as ae,E as oe,G as ne,T as se}from"./app-Bugz-iNi.js";import{s as ie,_ as le}from"./SmenaViewer.vue_vue_type_script_setup_true_lang-BeCSBcCB.js";import{T as ce}from"./TransportListRepo-ZBGBKArP.js";import{C as de}from"./ChangeRepo-CuQtf340.js";import{O as pe}from"./OrganizationRepo-x8CShCxY.js";import"./index-BGFKsGrr.js";import"./PrimeInputs-Kvh6ksoT.js";import"./index-CdY0pthm.js";import"./index-DTsqhOZs.js";import"./index.esm-C88Gxk8I.js";var ue=Q`
    .p-chip {
        display: inline-flex;
        align-items: center;
        background: dt('chip.background');
        color: dt('chip.color');
        border-radius: dt('chip.border.radius');
        padding-block: dt('chip.padding.y');
        padding-inline: dt('chip.padding.x');
        gap: dt('chip.gap');
    }

    .p-chip-icon {
        color: dt('chip.icon.color');
        font-size: dt('chip.icon.font.size');
        width: dt('chip.icon.size');
        height: dt('chip.icon.size');
    }

    .p-chip-image {
        border-radius: 50%;
        width: dt('chip.image.width');
        height: dt('chip.image.height');
        margin-inline-start: calc(-1 * dt('chip.padding.y'));
    }

    .p-chip:has(.p-chip-remove-icon) {
        padding-inline-end: dt('chip.padding.y');
    }

    .p-chip:has(.p-chip-image) {
        padding-block-start: calc(dt('chip.padding.y') / 2);
        padding-block-end: calc(dt('chip.padding.y') / 2);
    }

    .p-chip-remove-icon {
        cursor: pointer;
        font-size: dt('chip.remove.icon.size');
        width: dt('chip.remove.icon.size');
        height: dt('chip.remove.icon.size');
        color: dt('chip.remove.icon.color');
        border-radius: 50%;
        transition:
            outline-color dt('chip.transition.duration'),
            box-shadow dt('chip.transition.duration');
        outline-color: transparent;
    }

    .p-chip-remove-icon:focus-visible {
        box-shadow: dt('chip.remove.icon.focus.ring.shadow');
        outline: dt('chip.remove.icon.focus.ring.width') dt('chip.remove.icon.focus.ring.style') dt('chip.remove.icon.focus.ring.color');
        outline-offset: dt('chip.remove.icon.focus.ring.offset');
    }
`,me={root:"p-chip p-component",image:"p-chip-image",icon:"p-chip-icon",label:"p-chip-label",removeIcon:"p-chip-remove-icon"},he=W.extend({name:"chip",style:ue,classes:me}),ve={name:"BaseChip",extends:Y,props:{label:{type:[String,Number],default:null},icon:{type:String,default:null},image:{type:String,default:null},removable:{type:Boolean,default:!1},removeIcon:{type:String,default:void 0}},style:he,provide:function(){return{$pcChip:this,$parentInstance:this}}},M={name:"Chip",extends:ve,inheritAttrs:!1,emits:["remove"],data:function(){return{visible:!0}},methods:{onKeydown:function(r){(r.key==="Enter"||r.key==="Backspace")&&this.close(r)},close:function(r){this.visible=!1,this.$emit("remove",r)}},computed:{dataP:function(){return Z({removable:this.removable})}},components:{TimesCircleIcon:X}},fe=["aria-label","data-p"],ge=["src"];function be(e,r,d,s,i,f){return i.visible?(t(),n("div",S({key:0,class:e.cx("root"),"aria-label":e.label},e.ptmi("root"),{"data-p":f.dataP}),[K(e.$slots,"default",{},function(){return[e.image?(t(),n("img",S({key:0,src:e.image},e.ptm("image"),{class:e.cx("image")}),null,16,ge)):e.$slots.icon?(t(),k(F(e.$slots.icon),S({key:1,class:e.cx("icon")},e.ptm("icon")),null,16,["class"])):e.icon?(t(),n("span",S({key:2,class:[e.cx("icon"),e.icon]},e.ptm("icon")),null,16)):C("",!0),e.label?(t(),n("div",S({key:3,class:e.cx("label")},e.ptm("label")),T(e.label),17)):C("",!0)]}),e.removable?K(e.$slots,"removeicon",{key:0,removeCallback:f.close,keydownCallback:f.onKeydown},function(){return[(t(),k(F(e.removeIcon?"span":"TimesCircleIcon"),S({class:[e.cx("removeIcon"),e.removeIcon],onClick:f.close,onKeydown:f.onKeydown},e.ptm("removeIcon")),null,16,["class","onClick","onKeydown"]))]}):C("",!0)],16,fe)):C("",!0)}M.render=be;const I="groups",A={index(){return z.get(`${I}`)},byTransport(e){return z.get(`${I}/transport/${e}`)},show(e){return z.get(`${I}/${e}`)},async store(e){return await z.post(`${I}`,e)},update(e,r){return z.put(`${I}/${e}`,r)},destroy(e){return z.delete(`${I}/${e}`)}},ye={class:"font-sans"},_e={class:"flex gap-5"},xe={class:"w-1/3 rounded-xl h-fit"},ke={class:"flex flex-col gap-2"},we=["onDragstart"],$e={class:"font-medium text-gray-700 leading-4"},Ce={class:"block"},Te={class:"text-slate-500 text-sm"},De={class:"w-2/3 grid grid-cols-1 gap-4"},Be={class:"flex justify-between items-center border-b border-gray-100 py-3 px-4"},Se={class:"font-semibold text-gray-600 text-sm"},ze={class:"flex flex-grow"},Ie=["onDragover","onDrop"],Re={class:"absolute top-2 right-2"},Ee={key:1,class:"w-6 h-6 rounded-full bg-blue-100 text-blue-600 inline-flex items-center justify-center text-sm"},Le={class:"flex flex-wrap gap-2 p-3 items-start animate-pop-in"},je=L({__name:"DragBlock",props:{list:{},lavozims:{},transport:{},changes:{}},setup(e){const r=D(null),d=ee(),s=D(),i=e,{execute:f,data:y}=O(A.byTransport);function _(p){const a=i.changes.find(c=>c.id==p);return a?a.name:null}const h=new Set(Object.values(i.transport.smena.formula.first)),u=D(null),g=D(null),m=(p,a)=>{u.value=a,p.dataTransfer&&(p.dataTransfer.effectAllowed="copy",p.dataTransfer.setData("text/plain",JSON.stringify(a)))},E=(p,a)=>{s.value!=a&&(s.value=a)},V=async(p,a,c)=>{var o,v;s.value=null;const B={transport_id:i.transport.id,change_id:c,employe_id:(o=u.value)==null?void 0:o.id,lavozim_id:a.id};if(u.value){if(a[c].some($=>{var j;return $.employe.id===((j=u.value)==null?void 0:j.id)}))return d.add({severity:"warn",summary:"Takrorlamang!",detail:`${(v=u.value)==null?void 0:v.name} bu smenada  mavjud.`,life:5e3});r.value=a[c],await A.store(B).then($=>{a[c].push($.data)}).catch(()=>{var $;d.add({severity:"error",summary:`${($=u.value)==null?void 0:$.name} bu smenada  mavjud.`,detail:"Bir kishi bir smenada ikki lavozimda ishlay olmaydi!",life:5e3})}).finally(()=>{r.value=null}),u.value=null}},H=(p,a,c)=>{A.destroy(p).then(B=>{a.splice(c,1)})};return P(async()=>{await f(i.transport.id),g.value=i.lavozims.map(p=>(h.forEach(a=>{var B;const c=(B=y.value)==null?void 0:B.filter(o=>o.change_id==a&&o.lavozim_id==p.id&&o.transport_id==i.transport.id);p[a]=[],c==null||c.forEach(o=>{p[a].push(o)})}),p))}),(p,a)=>{const c=ie,B=M;return t(),n("div",ye,[l("div",_e,[l("div",xe,[l("div",ke,[g.value==null?(t(),n(b,{key:0},x(6,o=>U(c,{height:"42px",width:"100%","border-radius":"24px"})),64)):(t(!0),n(b,{key:1},x(i.list.employes,o=>(t(),n("div",{key:o.id,draggable:"true",onDragstart:v=>m(v,o),class:"rounded-3xl py-2 px-4 bg-white border border-surface-100 cursor-grab active:cursor-grabbing hover:bg-blue-50 hover:border-blue-300 transition-all flex items-center gap-3"},[l("div",$e,[l("span",Ce,T(o.name),1),l("span",Te," Razryad: "+T(o.razryad),1)]),a[1]||(a[1]=l("i",{class:"pi pi-clone ml-auto text-sky-600 text-sm mr-2"},null,-1))],40,we))),128))])]),l("div",De,[g.value==null?(t(),n(b,{key:0},x(2,o=>U(c,{"border-radius":"12px",height:"208px",width:"100%"})),64)):(t(!0),n(b,{key:1},x(g.value,o=>(t(),n("div",{key:o.id,class:"min-h-52 border border-surface-100 rounded-xl flex flex-col bg-white"},[l("div",Be,[l("span",Se,T(o.name),1)]),l("main",ze,[(t(!0),n(b,null,x(R(h),v=>(t(),n("div",{onDragover:te(w=>E(w,o[v]),["prevent"]),onDragleave:a[0]||(a[0]=w=>s.value=null),onDrop:w=>V(w,o,v),class:q([{"bg-surface-50":s.value==o[v]},"basis-0 flex-grow border-l first:border-0 border-surface-100 h-full relative transition-all"])},[l("span",Re,[r.value==o[v]?(t(),k(c,{key:0,shape:"circle",height:"24px",width:"24px"})):(t(),n("span",Ee,T(_(v)),1))]),l("div",Le,[(t(!0),n(b,null,x(o[v],(w,$)=>(t(),k(B,{onRemove:j=>H(w.id,o[v],$),key:w,label:w.employe.name,class:"text-xs! animate-pop-in",removable:""},null,8,["onRemove","label"]))),128))])],42,Ie))),256))])]))),128))])])])}}}),Ae=re(je,[["__scopeId","data-v-512ee3c2"]]),J=L({__name:"TabButton",props:{active:{type:Boolean},direction:{default:"bottom"}},setup(e){const r=e,d={left:{border:"border-l hover:border-l-gray-500 dark:hover:border-l-gray-300",active:"!border-l-gray-500 dark:!border-l-gray-300",different:"right-px"},right:{border:"border-r hover:border-r-gray-500 dark:hover:border-r-gray-300",active:"!border-r-gray-500 dark:!border-r-gray-300",different:"left-px"},top:{border:"border-t hover:border-t-gray-500 dark:hover:border-t-gray-300",active:"!border-t-gray-500 dark:!border-t-gray-300",different:"bottom-px"},bottom:{border:"border-b hover:border-b-gray-500 dark:hover:border-b-gray-300",active:"!border-b-gray-600 dark:!border-b-gray-300",different:"top-px"}};return(s,i)=>(t(),n("button",{class:q(["py-1 text-sm px-3 border-transparent cursor-pointer relative",[{"font-semibold":r.active},{[d[r.direction].active]:r.active},d[r.direction].border,d[r.direction].different]])},[K(s.$slots,"default")],2))}}),Ke={class:"flex flex-grow w-full"},Ne={class:"flex flex-col gap-0.5 items-end py-8 min-w-40"},Oe={class:"p-8 flex-grow dark:bg-zinc-900 border border-gray-200/80 dark:border-zinc-600 rounded-4xl min-h-154"},Pe=L({__name:"ActiveTransportTab",props:{transport_type:{}},setup(e){const r=e,d=D([]),s=D(null),i=D(null),{execute:f,data:y}=O(de.index);async function _(h,u){i.value=null,s.value=null,await ae(),s.value=h,i.value=u}return P(async()=>{const{data:h}=await ce.byTransportType(r.transport_type.id);await f(),d.value=h,h.length>0&&h[0].transports[0]&&_(h[0].transports[0],h[0])}),(h,u)=>(t(),n("main",Ke,[l("nav",Ne,[(t(!0),n(b,null,x(d.value,g=>(t(),n(b,null,[(t(!0),n(b,null,x(g.transports,m=>{var E;return t(),k(J,{class:"w-full text-left",direction:"right",onClick:V=>_(m,g),active:((E=s.value)==null?void 0:E.id)==m.id},{default:N(()=>[G(T(m.garage_number)+" "+T(g.name),1)]),_:2},1032,["onClick","active"])}),256))],64))),256))]),l("aside",Oe,[i.value&&s.value&&R(y)?(t(),k(Ae,{key:0,class:"mb-4",changes:R(y),list:i.value,lavozims:r.transport_type.lavozims,transport:s.value},null,8,["changes","list","lavozims","transport"])):C("",!0),l("main",null,[s.value?(t(),k(le,{key:0,transport:s.value},null,8,["transport"])):C("",!0)])])]))}}),Ve={key:0,name:"tabs",class:"flex flex-col p-5"},Fe={class:"flex gap-0.5 dark:border-zinc-600 pl-48"},Ue={class:"relative"},et=L({__name:"OrganizationPage",props:["id"],setup(e){const r=e,d=D(null),s=oe(),{execute:i,isLoading:f,data:y}=O(pe.transports);return ne(()=>r.id,_=>i({id:_})),P(async()=>{var _;s.isAdmin?await i({id:r.id}):await i({id:(_=s.user)==null?void 0:_.organization_id}),y.value&&y.value.transport_types[0]&&(d.value=y.value.transport_types[0].id)}),(_,h)=>{var u,g;return R(f)?C("",!0):(t(),n("section",Ve,[l("nav",Fe,[(t(!0),n(b,null,x((u=R(y))==null?void 0:u.transport_types,m=>(t(),k(J,{class:"text-xl!",active:d.value==m.id,onClick:E=>d.value=m.id},{default:N(()=>[G(T(m.name),1)]),_:2},1032,["active","onClick"]))),256))]),l("main",Ue,[(t(!0),n(b,null,x((g=R(y))==null?void 0:g.transport_types,m=>(t(),k(se,{name:"fade",mode:"out-in"},{default:N(()=>[m.id===d.value?(t(),k(Pe,{key:m.id,transport_type:m},null,8,["transport_type"])):C("",!0)]),_:2},1024))),256))])]))}}});export{et as default};
