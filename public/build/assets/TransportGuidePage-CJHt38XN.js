import{s as G,a as O}from"./index-B8-WGO63.js";import{d as I,q as k,o as R,c as m,a as r,k as b,F as T,r as C,w as $,v as U,f as l,t as j,n as P,g as L,i as A,y as E,u as Y,z as H}from"./app-C4GmJSBZ.js";import{b as J,a as B,P as D,c as K,g as z,d as Q,s as F}from"./PrimeInputs-BpjKOdBv.js";import{C as W}from"./ChangeRepo-Cv2ole86.js";import{_ as X}from"./UseCrudPage.vue_vue_type_script_setup_true_lang-D6rCueQf.js";import{a as p}from"./index-BGY1eZ2G.js";const Z={key:0,class:"mb-4 h-full"},ee={class:"mb-4"},te={class:"border border-white bg-gray-50 w-7 h-7 text-center content-center"},ne={class:"text-sm leading-1"},ae={class:"border border-white bg-gray-50 w-7 h-7 text-center"},re={class:"border border-white bg-gray-50 w-7 h-7 text-center"},se={key:1,class:"pt-2"},oe=I({__name:"SmenaViewer",props:{transport:{}},setup(n){const t=n,d=k(new Date),y=k();function h(s){var o;const e=(o=g.value)==null?void 0:o.find(i=>i.id==s);return e||null}const{data:g}=W.index();function v(s){y.value=M(s)}function S(s,e){const i=e.getTime()-s.getTime();return Math.round(i/864e5)}function M(s){if(t.transport.smena==null||t.transport.start_smena_day==null)return;const e=t.transport.start_smena_day?new Date(t.transport.start_smena_day):null,o=Object.keys(t.transport.smena.formula.first).length,i=s.getFullYear(),a=s.getMonth(),c=[],V=[],N=new Date(i,a+1,0).getDate();for(let f=1;f<=N;f++){const w=new Date(i,a,f);if(S(e,w)%o==0){if(c.push({date:w,number:1,startSmena:!0}),f<=o)for(let u=o-1;u>0;u--){const x=o-u,q=new Date(i,a,f-x);w.getMonth()==q.getMonth()&&V.unshift({date:q,number:u+1})}for(let u=1;u<o;u++){const x=new Date(i,a,f+u);w.getMonth()==x.getMonth()&&c.push({date:x,number:u+1})}}}return V.concat(c)}return R(()=>{v(d.value)}),(s,e)=>{const o=J,i=G;return t.transport.smena&&t.transport.start_smena_day?(l(),m("div",Z,[r("nav",ee,[b(o,{modelValue:d.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>d.value=a),v],view:"month",class:"p-0!",dateFormat:"yy-mm",size:"small"},null,8,["modelValue"])]),r("table",null,[r("tbody",null,[r("tr",null,[e[1]||(e[1]=r("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},null,-1)),(l(!0),m(T,null,C(y.value,a=>(l(),m("td",te,[r("span",ne,j(a.date.getDate()),1)]))),256))]),r("tr",null,[e[2]||(e[2]=r("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[r("span",{class:"p-button-icon pi pi-sun text-orange-400"})],-1)),(l(!0),m(T,null,C(y.value,a=>{var c;return l(),m("td",ae,[r("div",{class:P(["h-full w-full flex items-center justify-center border border-gray-200",{"border-l-zinc-900":a.startSmena}])},j((c=h(t.transport.smena.formula.first[a.number]))==null?void 0:c.name),3)])}),256))]),r("tr",null,[e[3]||(e[3]=r("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[r("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"})],-1)),(l(!0),m(T,null,C(y.value,a=>{var c;return l(),m("td",re,[r("div",{class:P(["h-full w-full flex items-center justify-center border border-gray-200",{"border-l-zinc-900":a.startSmena}])},j((c=h(t.transport.smena.formula.second[a.number]))==null?void 0:c.name),3)])}),256))])])])])):(l(),m("div",se,[b(i,{severity:"warn"},{default:$(()=>e[4]||(e[4]=[U("Smena turi va Smena birinchi kunini tanlash shart")])),_:1,__:[4]})]))}}}),_="transports",ie={index(){return p.get(`${_}`)},show(n){return p.get(`${_}/${n}`)},store(n){return p.post(`${_}`,n)},update(n,t){return p.put(`${_}/${n}`,t)},destroy(n){return p.delete(`${_}/${n}`)},inputs:[{component:D.Select,name:"transport_list_id",placeholder:"Transport turi",generateProps:async function(){const{data:n}=await p.get("transport-types");this.props=F(n,"name")},schema:B().required("Majburiy maydon!"),class:["mb-4"]},{component:D.InputText,name:"garage_number",placeholder:"Garaj raqami",props:z,schema:K().trim().required("Majburiy maydon!"),class:["mb-4"]},{component:D.Select,name:"smena_id",placeholder:"Smena turi",generateProps:async function(){const{data:n}=await p.get("smena");this.props=F(n,"name")},schema:B().required("Majburiy maydon!"),class:["mb-4"]},{component:D.DatePicker,name:"start_smena_day",placeholder:"Smena birinchi kuni",props:{...z,dateFormat:"yy-mm-dd"},schema:Q().required("Majburiy maydon!"),class:["mb-4"]}],columns:[{field:"transport_list.name",header:"Transport turi"},{field:"garage_number",header:"Garaj raqami"},{field:"smena.name",header:"Smena nomi"},{field:"start_smena_day",header:"Smena boshlanish vaqti"}]},fe=I({__name:"TransportGuidePage",setup(n){const t=k(null),d=k(!1);function y(h){t.value=h,d.value=!0}return(h,g)=>{const v=H,S=E,M=O;return l(),m("section",null,[t.value?(l(),L(v,{key:0,visible:d.value,"onUpdate:visible":g[0]||(g[0]=s=>d.value=s),maximizable:"",modal:"",header:"Smena turi",breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:$(()=>[b(oe,{transport:t.value},null,8,["transport"])]),_:1},8,["visible"])):A("",!0),b(X,{"entity-repo":Y(ie)},{column:$(()=>[b(M,{style:{width:"50px"}},{body:$(({data:s})=>[b(S,{icon:"pi pi-eye",type:"button",onClick:e=>y(s),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1})]),_:1},8,["entity-repo"])])}}});export{fe as default};
