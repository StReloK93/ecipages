import{s as L,a as H,_ as J,b as oe,c as re}from"./BaseForm.vue_vue_type_script_setup_true_lang-C2v4_LeH.js";import{B as le,s as ae,g as F,S as W,o as w,w as x,m as U,U as se,n as ie,a6 as ue,a7 as de,$ as X,a8 as O,u as R,d as M,a9 as ce,k as S,aa as me,c as $,a as l,p as T,t as j,F as V,r as k,v as Y,b as h,h as Z,l as pe,x as fe,y as ve,_ as be}from"./app-Dqq4a65M.js";import{C as ee,S as E}from"./SmenaRepo-COpIk1m2.js";import"./useFetch-D45EbHv3.js";var ye={root:"p-formfield p-component"},he=le.extend({name:"formfield",classes:ye}),ge={name:"BaseFormField",extends:ae,style:he,props:{name:{type:String,default:void 0},resolver:{type:Function,default:void 0},initialValue:{type:null,default:void 0},validateOnValueUpdate:{type:Boolean,default:void 0},validateOnBlur:{type:Boolean,default:void 0},validateOnMount:{type:Boolean,default:void 0},validateOnSubmit:{type:Boolean,default:void 0},as:{type:[String,Object],default:"DIV"},asChild:{type:Boolean,default:!1}},provide:function(){return{$pcFormField:this,$parentInstance:this}}};function B(e){"@babel/helpers - typeof";return B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(e)}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),n.push.apply(n,o)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?G(Object(n),!0).forEach(function(o){we(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function we(e,t,n){return(t=_e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e){var t=xe(e,"string");return B(t)=="symbol"?t:t+""}function xe(e,t){if(B(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(B(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N={name:"FormField",extends:ge,inheritAttrs:!1,inject:{$pcForm:{default:void 0}},watch:{formControl:{immediate:!0,handler:function(t){var n,o;(n=this.$pcForm)===null||n===void 0||(o=n.register)===null||o===void 0||o.call(n,this.name,t)}}},computed:{formControl:function(){return{name:this.name,resolver:this.resolver,initialValue:this.initialValue,validateOnValueUpdate:this.validateOnValueUpdate,validateOnBlur:this.validateOnBlur,validateOnMount:this.validateOnMount,validateOnSubmit:this.validateOnSubmit}},field:function(){var t;return((t=this.$pcForm)===null||t===void 0||(t=t.fields)===null||t===void 0?void 0:t[this.name])||{}},fieldAttrs:function(){return K(K({},this.field.props),this.field.states)}}};function $e(e,t,n,o,d,a){return e.asChild?W(e.$slots,"default",U({key:1,class:e.cx("root"),props:a.field.props},a.fieldAttrs)):(w(),F(se(e.as),U({key:0,class:e.cx("root")},e.ptmi("root")),{default:x(function(){return[W(e.$slots,"default",U({props:a.field.props},a.fieldAttrs))]}),_:3},16,["class"]))}N.render=$e;function Se(e){return ue()?(de(e),!0):!1}const te=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Oe=Object.prototype.toString,Ve=e=>Oe.call(e)==="[object Object]",C=()=>{},ke=Ce();function Ce(){var e,t;return te&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window==null?void 0:window.navigator)==null?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function z(e){return Array.isArray(e)?e:[e]}function Fe(e,t,n){return ie(e,t,{...n,immediate:!0})}const ne=te?window:void 0;function A(e){var t;const n=O(e);return(t=n==null?void 0:n.$el)!=null?t:n}function D(...e){const t=[],n=()=>{t.forEach(r=>r()),t.length=0},o=(r,i,m,p)=>(r.addEventListener(i,m,p),()=>r.removeEventListener(i,m,p)),d=X(()=>{const r=z(O(e[0])).filter(i=>i!=null);return r.every(i=>typeof i!="string")?r:void 0}),a=Fe(()=>{var r,i;return[(i=(r=d.value)==null?void 0:r.map(m=>A(m)))!=null?i:[ne].filter(m=>m!=null),z(O(d.value?e[1]:e[0])),z(R(d.value?e[2]:e[1])),O(d.value?e[3]:e[2])]},([r,i,m,p])=>{if(n(),!(r!=null&&r.length)||!(i!=null&&i.length)||!(m!=null&&m.length))return;const c=Ve(p)?{...p}:p;t.push(...r.flatMap(v=>i.flatMap(f=>m.map(y=>o(v,f,y,c)))))},{flush:"post"}),b=()=>{a(),n()};return Se(n),b}let Q=!1;function je(e,t,n={}){const{window:o=ne,ignore:d=[],capture:a=!0,detectIframe:b=!1,controls:r=!1}=n;if(!o)return r?{stop:C,cancel:C,trigger:C}:C;if(ke&&!Q){Q=!0;const u={passive:!0};Array.from(o.document.body.children).forEach(s=>s.addEventListener("click",C,u)),o.document.documentElement.addEventListener("click",C,u)}let i=!0;const m=u=>O(d).some(s=>{if(typeof s=="string")return Array.from(o.document.querySelectorAll(s)).some(g=>g===u.target||u.composedPath().includes(g));{const g=A(s);return g&&(u.target===g||u.composedPath().includes(g))}});function p(u){const s=O(u);return s&&s.$.subTree.shapeFlag===16}function c(u,s){const g=O(u),P=g.$.subTree&&g.$.subTree.children;return P==null||!Array.isArray(P)?!1:P.some(q=>q.el===s.target||s.composedPath().includes(q.el))}const v=u=>{const s=A(e);if(u.target!=null&&!(!(s instanceof Element)&&p(e)&&c(e,u))&&!(!s||s===u.target||u.composedPath().includes(s))){if("detail"in u&&u.detail===0&&(i=!m(u)),!i){i=!0;return}t(u)}};let f=!1;const y=[D(o,"click",u=>{f||(f=!0,setTimeout(()=>{f=!1},0),v(u))},{passive:!0,capture:a}),D(o,"pointerdown",u=>{const s=A(e);i=!m(u)&&!!(s&&!u.composedPath().includes(s))},{passive:!0}),b&&D(o,"blur",u=>{setTimeout(()=>{var s;const g=A(e);((s=o.document.activeElement)==null?void 0:s.tagName)==="IFRAME"&&!(g!=null&&g.contains(o.document.activeElement))&&t(u)},0)},{passive:!0})].filter(Boolean),_=()=>y.forEach(u=>u());return r?{stop:_,cancel:()=>{i=!1},trigger:u=>{i=!0,v(u),i=!1}}:_}const Pe={key:0,class:"absolute top-full bg-white w-full border border-transparent translate-y-px z-[100]"},Ee=["onClick"],I=M({__name:"MiniSelect",props:ce({data:{},name:{},value:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=S(),n=me(e,"modelValue"),o=S(!1),d=e;je(t,r=>o.value=!1);const a=X(()=>d.data.find(r=>(d.value?r[d.value]:r)==n.value));function b(r){r?n.value=d.value?r[d.value]:r:n.value=void 0,o.value=!1}return(r,i)=>(w(),$("section",{ref_key:"miniSelect",ref:t,class:"relative w-6 h-6 text-sm"},[l("button",{type:"button",onClick:i[0]||(i[0]=m=>o.value=!0),class:"cursor-pointer bg-white text-center w-full h-full"},j(d.name&&a.value?a.value[d.name]:a.value),1),o.value?(w(),$("nav",Pe,[l("div",null,[l("button",{type:"button",onClick:i[1]||(i[1]=m=>b(void 0)),class:"w-full h-full text-center border border-transparent border-y-2 border-y-white bg-zinc-100 hover:bg-zinc-200 cursor-pointer"},i[2]||(i[2]=[l("span",{class:"p-button-icon pi pi-times !text-[10px] text-red-500"},null,-1)])),(w(!0),$(V,null,k(d.data,m=>(w(),$("button",{type:"button",onClick:p=>b(m),class:"w-full text-center border border-transparent border-b-2 last:border-b-0 border-b-white bg-zinc-100 hover:bg-zinc-200 cursor-pointer"},j(d.name?m[d.name]:m),9,Ee))),256))])])):T("",!0)],512))}}),Ae={class:"mb-4 h-full"},Be={class:"mb-10"},Ie={class:"border border-white bg-gray-50 w-7 h-7 text-center content-center"},Me={class:"text-sm leading-1"},Te={class:"border border-white bg-gray-50 w-7 h-7 text-center"},Ue={class:"border border-white bg-gray-50 w-7 h-7 text-center"},ze={class:"h-full w-full flex items-center justify-center border border-gray-200"},De={class:"mb-4"},Re=M({__name:"FormCreateSmena",props:{submit:{type:Function}},setup(e){const t=S([]);ee.index(({data:d})=>{t.value=d});const n=Y({name:"",formula:{first:{},second:{}}}),o=({values:d})=>{const a={},b="To'ldiring";return d.name||(a.name=[b]),{values:d,errors:a}};return(d,a)=>{const b=N,r=L,i=H;return w(),F(J,{class:"h-full",submit:d.submit,resolver:o,initialValues:n,onClose:a[1]||(a[1]=m=>d.$emit("close"))},{default:x(m=>{var p;return[l("div",Ae,[h(b,{name:"formula"},{default:x(c=>[l("table",Be,[l("tr",null,[a[2]||(a[2]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},null,-1)),(w(),$(V,null,k(30,v=>l("td",Ie,[l("span",Me,j(v),1)])),64))]),l("tr",null,[a[3]||(a[3]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[l("span",{class:"p-button-icon pi pi-sun text-orange-400"})],-1)),(w(),$(V,null,k(30,v=>l("td",Te,[l("div",{onClick:a[0]||(a[0]=()=>{}),class:"h-full w-full flex items-center justify-center border border-gray-200"},[h(I,{modelValue:c.value.first[v],"onUpdate:modelValue":f=>c.value.first[v]=f,name:"name",value:"id",data:t.value},null,8,["modelValue","onUpdate:modelValue","data"])])])),64))]),l("tr",null,[a[4]||(a[4]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[l("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"})],-1)),(w(),$(V,null,k(30,v=>l("td",Ue,[l("div",ze,[h(I,{modelValue:c.value.second[v],"onUpdate:modelValue":f=>c.value.second[v]=f,name:"name",value:"id",data:t.value},null,8,["modelValue","onUpdate:modelValue","data"])])])),64))])])]),_:1}),a[5]||(a[5]=l("div",{class:"flex-grow"},null,-1)),l("div",De,[h(r,{placeholder:"Smena turi nomi",name:"name",size:"small",inputId:"integeronly",fluid:""}),(p=m.form.name)!=null&&p.invalid?(w(),F(i,{key:0,severity:"error",size:"small",variant:"simple"},{default:x(()=>[Z(j(m.form.name.error),1)]),_:2},1024)):T("",!0)])])]}),_:1},8,["submit","initialValues"])}}}),Le={class:"mb-4 h-full"},Ne={class:"mb-10"},qe={class:"border border-white bg-gray-50 w-7 h-7 text-center content-center"},We={class:"text-sm leading-1"},Ge={class:"border border-white bg-gray-50 w-7 h-7 text-center"},Ke={class:"h-full w-full flex items-center justify-center border border-gray-200"},Qe={class:"border border-white bg-gray-50 w-7 h-7 text-center"},He={class:"h-full w-full flex items-center justify-center border border-gray-200"},Je={class:"mb-4"},Xe=M({__name:"FormEditSmena",props:{submit:{type:Function},smena_id:{}},setup(e){const t=S(null),n=e,o=S([]);ee.index(({data:b})=>{o.value=b});const d=Y({name:"",formula:{first:{},second:{}}}),a=({values:b})=>{const r={},i="To'ldiring";return b.name||(r.name=[i]),{values:b,errors:r}};return pe(()=>{n.smena_id&&E.show(n.smena_id,({data:b})=>{t.value&&(t.value.instance.setFieldValue("name",b.name),t.value.instance.setFieldValue("formula",b.formula))})}),(b,r)=>{const i=N,m=L,p=H;return w(),F(J,{ref_key:"form",ref:t,class:"h-full",submit:b.submit,resolver:a,initialValues:d,onClose:r[0]||(r[0]=c=>b.$emit("close"))},{default:x(c=>{var v;return[l("div",Le,[h(i,{name:"formula"},{default:x(f=>[l("table",Ne,[l("tbody",null,[l("tr",null,[r[1]||(r[1]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},null,-1)),(w(),$(V,null,k(30,y=>l("td",qe,[l("span",We,j(y),1)])),64))]),l("tr",null,[r[2]||(r[2]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[l("span",{class:"p-button-icon pi pi-sun text-orange-400"})],-1)),(w(),$(V,null,k(30,y=>l("td",Ge,[l("div",Ke,[h(I,{modelValue:f.value.first[y],"onUpdate:modelValue":_=>f.value.first[y]=_,name:"name",value:"id",data:o.value},null,8,["modelValue","onUpdate:modelValue","data"])])])),64))]),l("tr",null,[r[3]||(r[3]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[l("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"})],-1)),(w(),$(V,null,k(30,y=>l("td",Qe,[l("div",He,[h(I,{modelValue:f.value.second[y],"onUpdate:modelValue":_=>f.value.second[y]=_,name:"name",value:"id",data:o.value},null,8,["modelValue","onUpdate:modelValue","data"])])])),64))])])])]),_:1}),r[4]||(r[4]=l("div",{class:"flex-grow"},null,-1)),l("div",Je,[h(m,{placeholder:"Smena turi nomi",name:"name",size:"small",inputId:"integeronly",fluid:""}),(v=c.form.name)!=null&&v.invalid?(w(),F(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:x(()=>[Z(j(c.form.name.error),1)]),_:2},1024)):T("",!0)])])]}),_:1},8,["submit","initialValues"])}}}),Ye={class:"mb-3 text-end"},ot=M({__name:"SmenaGuidePage",setup(e){const t=S(null),n=S(!1),o=S(!1),d=fe(),{data:a}=E.index();async function b(p){await new Promise((c,v)=>{E.store(p,({data:f})=>{var y;c(!0),(y=a.value)==null||y.push(f),n.value=!1})})}function r(p){t.value=p,o.value=!0}const i=p=>{d.require({message:`(${p.name}) - Aniq o'chirmoqchimisiz?`,header:"O'chirish",rejectProps:{label:"Bekor qilish",severity:"secondary",outlined:!0},acceptProps:{label:"O'chirish",severity:"danger"},accept:()=>{E.destroy(p.id||0,()=>{var v,f;const c=(v=a.value)==null?void 0:v.findIndex(y=>y.id==p.id);c>-1&&((f=a.value)==null||f.splice(c,1))})}})};async function m(p){await new Promise((c,v)=>{t.value&&a.value&&E.update(t.value,p,f=>{var u;const y=(u=a.value)==null?void 0:u.findIndex(s=>s.id==t.value);let _=a.value;_&&_[y]&&(_[y].name=f.data.name),o.value=!1,c(f)})})}return(p,c)=>{const v=ve,f=be,y=L,_=oe,u=re;return w(),$("div",null,[l("main",Ye,[h(v,{icon:"pi pi-plus",label:"Qo'shish",size:"small",severity:"contrast",onClick:c[0]||(c[0]=s=>n.value=!0)}),h(f,{visible:n.value,"onUpdate:visible":c[2]||(c[2]=s=>n.value=s),maximizable:"",modal:"",header:"Smena turi",breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:x(()=>[h(Re,{onClose:c[1]||(c[1]=s=>n.value=!1),submit:b})]),_:1},8,["visible"]),h(f,{visible:o.value,"onUpdate:visible":c[4]||(c[4]=s=>o.value=s),maximizable:"",modal:"",header:"Smena turi",breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:x(()=>[h(Xe,{smena_id:t.value,onClose:c[3]||(c[3]=s=>o.value=!1),submit:m},null,8,["smena_id"])]),_:1},8,["visible"])]),R(a)?(w(),F(u,{key:0,size:"small",value:R(a),editMode:"row",dataKey:"id"},{default:x(()=>[h(_,{field:"name",header:"Nomi"},{editor:x(({data:s,field:g})=>[h(y,{modelValue:s[g],"onUpdate:modelValue":P=>s[g]=P,type:"text",size:"small",fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),h(_,{style:{width:"50px"}},{body:x(({data:s})=>[h(v,{icon:"pi pi-pencil",type:"button",onClick:g=>r(s.id),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1}),h(_,{style:{width:"50px"}},{body:x(({data:s})=>[h(v,{icon:"pi pi-trash",type:"button",onClick:g=>i(s),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1})]),_:1},8,["value"])):T("",!0)])}}});export{ot as default};
