import{a as ie,s as ue}from"./index-1ZFrtC1P.js";import{s as G}from"./index-CR8TXXMo.js";import{B as de,j as ce,h as $,m as W,e as b,w as x,n as L,p as me,H as pe,ae as fe,af as ve,x as Z,ag as F,b as S,d as D,ah as be,q as O,ai as ye,c as V,a as s,l as C,t as E,F as j,r as P,y as _,I as ee,u as K,U as te,o as H,D as ne,A,V as he,J as ge}from"./app-2Osvv3AR.js";import{s as oe}from"./index-BXqGvRMY.js";import{C as re}from"./ChangeRepo-Dhb__vO3.js";import{s as we}from"./index-D7SXmvpF.js";import"./index-BmEfAbUo.js";var _e={root:"p-formfield p-component"},xe=de.extend({name:"formfield",classes:_e}),$e={name:"BaseFormField",extends:ce,style:xe,props:{name:{type:String,default:void 0},resolver:{type:Function,default:void 0},initialValue:{type:null,default:void 0},validateOnValueUpdate:{type:Boolean,default:void 0},validateOnBlur:{type:Boolean,default:void 0},validateOnMount:{type:Boolean,default:void 0},validateOnSubmit:{type:Boolean,default:void 0},as:{type:[String,Object],default:"DIV"},asChild:{type:Boolean,default:!1}},provide:function(){return{$pcFormField:this,$parentInstance:this}}};function z(e){"@babel/helpers - typeof";return z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(e)}function Q(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),o.push.apply(o,n)}return o}function X(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Q(Object(o),!0).forEach(function(n){Se(e,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Q(Object(o)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})}return e}function Se(e,t,o){return(t=Ve(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Ve(e){var t=ke(e,"string");return z(t)=="symbol"?t:t+""}function ke(e,t){if(z(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var n=o.call(e,t);if(z(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J={name:"FormField",extends:$e,inheritAttrs:!1,inject:{$pcForm:{default:void 0}},watch:{formControl:{immediate:!0,handler:function(t){var o,n;(o=this.$pcForm)===null||o===void 0||(n=o.register)===null||n===void 0||n.call(o,this.name,t)}}},computed:{formControl:function(){return{name:this.name,resolver:this.resolver,initialValue:this.initialValue,validateOnValueUpdate:this.validateOnValueUpdate,validateOnBlur:this.validateOnBlur,validateOnMount:this.validateOnMount,validateOnSubmit:this.validateOnSubmit}},field:function(){var t;return((t=this.$pcForm)===null||t===void 0||(t=t.fields)===null||t===void 0?void 0:t[this.name])||{}},fieldAttrs:function(){return X(X({},this.field.props),this.field.states)}}};function Oe(e,t,o,n,m,d){return e.asChild?W(e.$slots,"default",L({key:1,class:e.cx("root"),props:d.field.props},d.fieldAttrs)):(b(),$(me(e.as),L({key:0,class:e.cx("root")},e.ptmi("root")),{default:x(function(){return[W(e.$slots,"default",L({props:d.field.props},d.fieldAttrs))]}),_:3},16,["class"]))}J.render=Oe;function Ce(e){return fe()?(ve(e),!0):!1}const le=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Fe=Object.prototype.toString,je=e=>Fe.call(e)==="[object Object]",B=()=>{},Pe=Be();function Be(){var e,t;return le&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window==null?void 0:window.navigator)==null?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function q(e){return Array.isArray(e)?e:[e]}function Ee(e,t,o){return pe(e,t,{...o,immediate:!0})}const se=le?window:void 0;function M(e){var t;const o=F(e);return(t=o==null?void 0:o.$el)!=null?t:o}function N(...e){const t=[],o=()=>{t.forEach(l=>l()),t.length=0},n=(l,r,c,g)=>(l.addEventListener(r,c,g),()=>l.removeEventListener(r,c,g)),m=Z(()=>{const l=q(F(e[0])).filter(r=>r!=null);return l.every(r=>typeof r!="string")?l:void 0}),d=Ee(()=>{var l,r;return[(r=(l=m.value)==null?void 0:l.map(c=>M(c)))!=null?r:[se].filter(c=>c!=null),q(F(m.value?e[1]:e[0])),q(S(m.value?e[2]:e[1])),F(m.value?e[3]:e[2])]},([l,r,c,g])=>{if(o(),!(l!=null&&l.length)||!(r!=null&&r.length)||!(c!=null&&c.length))return;const h=je(g)?{...g}:g;t.push(...l.flatMap(u=>r.flatMap(p=>c.map(y=>n(u,p,y,h)))))},{flush:"post"}),i=()=>{d(),o()};return Ce(o),i}let Y=!1;function Ae(e,t,o={}){const{window:n=se,ignore:m=[],capture:d=!0,detectIframe:i=!1,controls:l=!1}=o;if(!n)return l?{stop:B,cancel:B,trigger:B}:B;if(Pe&&!Y){Y=!0;const a={passive:!0};Array.from(n.document.body.children).forEach(v=>v.addEventListener("click",B,a)),n.document.documentElement.addEventListener("click",B,a)}let r=!0;const c=a=>F(m).some(v=>{if(typeof v=="string")return Array.from(n.document.querySelectorAll(v)).some(f=>f===a.target||a.composedPath().includes(f));{const f=M(v);return f&&(a.target===f||a.composedPath().includes(f))}});function g(a){const v=F(a);return v&&v.$.subTree.shapeFlag===16}function h(a,v){const f=F(a),k=f.$.subTree&&f.$.subTree.children;return k==null||!Array.isArray(k)?!1:k.some(T=>T.el===v.target||v.composedPath().includes(T.el))}const u=a=>{const v=M(e);if(a.target!=null&&!(!(v instanceof Element)&&g(e)&&h(e,a))&&!(!v||v===a.target||a.composedPath().includes(v))){if("detail"in a&&a.detail===0&&(r=!c(a)),!r){r=!0;return}t(a)}};let p=!1;const y=[N(n,"click",a=>{p||(p=!0,setTimeout(()=>{p=!1},0),u(a))},{passive:!0,capture:d}),N(n,"pointerdown",a=>{const v=M(e);r=!c(a)&&!!(v&&!a.composedPath().includes(v))},{passive:!0}),i&&N(n,"blur",a=>{setTimeout(()=>{var v;const f=M(e);((v=n.document.activeElement)==null?void 0:v.tagName)==="IFRAME"&&!(f!=null&&f.contains(n.document.activeElement))&&t(a)},0)},{passive:!0})].filter(Boolean),w=()=>y.forEach(a=>a());return l?{stop:w,cancel:()=>{r=!1},trigger:a=>{r=!0,u(a),r=!1}}:w}const Ie={key:0,class:"absolute top-full bg-white w-full border border-transparent translate-y-px z-[100]"},Me=["onClick"],R=D({__name:"MiniSelect",props:be({data:{},name:{},value:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=O(),o=ye(e,"modelValue"),n=O(!1),m=e;Ae(t,l=>n.value=!1);const d=Z(()=>m.data.find(l=>(m.value?l[m.value]:l)==o.value));function i(l){l?o.value=m.value?l[m.value]:l:o.value=void 0,n.value=!1}return(l,r)=>(b(),V("section",{ref_key:"miniSelect",ref:t,class:"relative w-6 h-6 text-sm"},[s("button",{type:"button",onClick:r[0]||(r[0]=c=>n.value=!0),class:"cursor-pointer bg-white text-center w-full h-full"},E(m.name&&d.value?d.value[m.name]:d.value),1),n.value?(b(),V("nav",Ie,[s("div",null,[s("button",{type:"button",onClick:r[1]||(r[1]=c=>i(void 0)),class:"w-full h-full text-center border border-transparent border-y-2 border-y-white bg-zinc-100 hover:bg-zinc-200 cursor-pointer"},r[2]||(r[2]=[s("span",{class:"p-button-icon pi pi-times !text-[10px] text-red-500"},null,-1)])),(b(!0),V(j,null,P(m.data,c=>(b(),V("button",{type:"button",onClick:g=>i(c),class:"w-full text-center border border-transparent border-b-2 last:border-b-0 border-b-white bg-zinc-100 hover:bg-zinc-200 cursor-pointer"},E(m.name?c[m.name]:c),9,Me))),256))])])):C("",!0)],512))}}),Ue={class:"flex flex-col"},ze={class:"flex gap-3"},ae=D({__name:"OldBaseForm",props:{initialValues:{},resolver:{},submit:{type:Function}},setup(e,{expose:t}){const o=O(),n=O(!1),m=e,d=async({valid:i,values:l})=>{i&&(n.value=!0,await m.submit(l).finally(()=>{n.value=!1}))};return t({instance:o}),(i,l)=>{const r=ee,c=we;return b(),$(c,{ref_key:"instance",ref:o,initialValues:i.initialValues,resolver:i.resolver,onSubmit:d,class:"flex flex-col gap-4 w-full"},{default:x(g=>[s("div",Ue,[W(i.$slots,"default",{form:g})]),l[1]||(l[1]=s("div",{class:"flex-grow"},null,-1)),s("main",ze,[_(r,{type:"button",size:"small",severity:"secondary",onClick:l[0]||(l[0]=h=>i.$emit("close")),label:"Bekor qilish",fluid:!0}),_(r,{type:"submit",size:"small",severity:"contrast",label:"Saqlash",fluid:!0,loading:n.value},null,8,["loading"])])]),_:3,__:[1]},8,["initialValues","resolver"])}}}),De={class:"mb-4 h-full"},Te={class:"mb-10"},Re={class:"border border-white bg-gray-50 w-7 h-7 text-center content-center"},Le={class:"text-sm leading-1"},qe={class:"border border-white bg-gray-50 w-7 h-7 text-center"},Ne={class:"border border-white bg-gray-50 w-7 h-7 text-center"},We={class:"h-full w-full flex items-center justify-center border border-gray-200"},Ge={class:"mb-4"},Ke=D({__name:"SmenaCreate",props:{submit:{type:Function}},setup(e){const{data:t,execute:o}=K(re.index),n=te({name:"",formula:{first:{},second:{}}}),m=({values:d})=>{const i={},l="To'ldiring";return d.name||(i.name=[l]),{values:d,errors:i}};return H(async()=>{await o()}),(d,i)=>{const l=J,r=G,c=oe;return b(),$(ae,{class:"h-full",submit:d.submit,resolver:m,initialValues:n,onClose:i[1]||(i[1]=g=>d.$emit("close"))},{default:x(g=>{var h;return[s("div",De,[_(l,{name:"formula"},{default:x(u=>[s("table",Te,[s("tbody",null,[s("tr",null,[i[2]||(i[2]=s("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},null,-1)),(b(),V(j,null,P(30,p=>s("td",Re,[s("span",Le,E(p),1)])),64))]),s("tr",null,[i[3]||(i[3]=s("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[s("span",{class:"p-button-icon pi pi-sun text-orange-400"})],-1)),(b(),V(j,null,P(30,p=>s("td",qe,[s("div",{onClick:i[0]||(i[0]=()=>{}),class:"h-full w-full flex items-center justify-center border border-gray-200"},[S(t)?(b(),$(R,{key:0,modelValue:u.value.first[p],"onUpdate:modelValue":y=>u.value.first[p]=y,name:"name",value:"id",data:S(t)},null,8,["modelValue","onUpdate:modelValue","data"])):C("",!0)])])),64))]),s("tr",null,[i[4]||(i[4]=s("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[s("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"})],-1)),(b(),V(j,null,P(30,p=>s("td",Ne,[s("div",We,[S(t)?(b(),$(R,{key:0,modelValue:u.value.second[p],"onUpdate:modelValue":y=>u.value.second[p]=y,name:"name",value:"id",data:S(t)},null,8,["modelValue","onUpdate:modelValue","data"])):C("",!0)])])),64))])])])]),_:1}),i[5]||(i[5]=s("div",{class:"flex-grow"},null,-1)),s("div",Ge,[_(r,{placeholder:"Smena turi nomi",name:"name",size:"small",inputId:"integeronly",fluid:""}),(h=g.form.name)!=null&&h.invalid?(b(),$(c,{key:0,severity:"error",size:"small",variant:"simple"},{default:x(()=>[ne(E(g.form.name.error),1)]),_:2},1024)):C("",!0)])])]}),_:1},8,["submit","initialValues"])}}}),I="smena",U={index(){return A.get(`${I}`)},show(e){return A.get(`${I}/${e}`)},store(e){return A.post(`${I}`,e)},update(e,t){return A.put(`${I}/${e}`,t)},destroy(e){return A.delete(`${I}/${e}`)}},He={class:"mb-4 h-full"},Je={class:"mb-10"},Qe={class:"border border-white bg-gray-50 w-7 h-7 text-center content-center"},Xe={class:"text-sm leading-1"},Ye={class:"border border-white bg-gray-50 w-7 h-7 text-center"},Ze={class:"h-full w-full flex items-center justify-center border border-gray-200"},et={class:"border border-white bg-gray-50 w-7 h-7 text-center"},tt={class:"h-full w-full flex items-center justify-center border border-gray-200"},nt={class:"mb-4"},ot=D({__name:"SmenaUpdate",props:{submit:{type:Function},smena_id:{}},setup(e){const t=O(null),o=e,{data:n,execute:m}=K(re.index),d=te({name:"",formula:{first:{},second:{}}}),i=({values:l})=>{const r={},c="To'ldiring";return l.name||(r.name=[c]),{values:l,errors:r}};return H(async()=>{await m();const{data:l}=await U.show(o.smena_id);t.value&&(t.value.instance.setFieldValue("name",l.name),t.value.instance.setFieldValue("formula",l.formula))}),(l,r)=>{const c=J,g=G,h=oe;return b(),$(ae,{ref_key:"form",ref:t,class:"h-full",submit:l.submit,resolver:i,initialValues:d,onClose:r[0]||(r[0]=u=>l.$emit("close"))},{default:x(u=>{var p;return[s("div",He,[_(c,{name:"formula"},{default:x(y=>[s("table",Je,[s("tbody",null,[s("tr",null,[r[1]||(r[1]=s("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},null,-1)),(b(),V(j,null,P(30,w=>s("td",Qe,[s("span",Xe,E(w),1)])),64))]),s("tr",null,[r[2]||(r[2]=s("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[s("span",{class:"p-button-icon pi pi-sun text-orange-400"})],-1)),(b(),V(j,null,P(30,w=>s("td",Ye,[s("div",Ze,[S(n)?(b(),$(R,{key:0,modelValue:y.value.first[w],"onUpdate:modelValue":a=>y.value.first[w]=a,name:"name",value:"id",data:S(n)},null,8,["modelValue","onUpdate:modelValue","data"])):C("",!0)])])),64))]),s("tr",null,[r[3]||(r[3]=s("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[s("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"})],-1)),(b(),V(j,null,P(30,w=>s("td",et,[s("div",tt,[S(n)?(b(),$(R,{key:0,modelValue:y.value.second[w],"onUpdate:modelValue":a=>y.value.second[w]=a,name:"name",value:"id",data:S(n)},null,8,["modelValue","onUpdate:modelValue","data"])):C("",!0)])])),64))])])])]),_:1}),r[4]||(r[4]=s("div",{class:"flex-grow"},null,-1)),s("div",nt,[_(g,{placeholder:"Smena turi nomi",name:"name",size:"small",inputId:"integeronly",fluid:""}),(p=u.form.name)!=null&&p.invalid?(b(),$(h,{key:0,severity:"error",size:"small",variant:"simple"},{default:x(()=>[ne(E(u.form.name.error),1)]),_:2},1024)):C("",!0)])])]}),_:1},8,["submit","initialValues"])}}}),rt={class:"mb-3 text-end"},mt=D({__name:"SmenaGuidePage",setup(e){const t=O(null),o=O(!1),n=O(!1),m=he(),{data:d,execute:i}=K(U.index);async function l(h){var p;const{data:u}=await U.store(h);(p=d.value)==null||p.push(u),o.value=!1}function r(h){t.value=h,n.value=!0}const c=h=>{m.require({message:`(${h.name}) - Aniq o'chirmoqchimisiz?`,header:"O'chirish",rejectProps:{label:"Bekor qilish",severity:"secondary",outlined:!0},acceptProps:{label:"O'chirish",severity:"danger"},accept:()=>{var p,y;U.destroy(h.id);const u=(p=d.value)==null?void 0:p.findIndex(w=>w.id==h.id);u>-1&&((y=d.value)==null||y.splice(u,1))}})};async function g(h){var u;if(t.value&&d.value){const p=await U.update(t.value,h),y=(u=d.value)==null?void 0:u.findIndex(a=>a.id==t.value);let w=d.value;w&&w[y]&&(w[y].name=p.data.name),n.value=!1}}return H(()=>{i()}),(h,u)=>{const p=ee,y=ge,w=G,a=ue,v=ie;return b(),V("div",null,[s("main",rt,[_(p,{icon:"pi pi-plus",label:"Qo'shish",size:"small",severity:"contrast",onClick:u[0]||(u[0]=f=>o.value=!0)}),_(y,{visible:o.value,"onUpdate:visible":u[2]||(u[2]=f=>o.value=f),maximizable:"",modal:"",header:"Smena turi",breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:x(()=>[_(Ke,{onClose:u[1]||(u[1]=f=>o.value=!1),submit:l})]),_:1},8,["visible"]),_(y,{visible:n.value,"onUpdate:visible":u[4]||(u[4]=f=>n.value=f),maximizable:"",modal:"",header:"Smena turi",breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:x(()=>[_(ot,{smena_id:t.value,onClose:u[3]||(u[3]=f=>n.value=!1),submit:g},null,8,["smena_id"])]),_:1},8,["visible"])]),S(d)?(b(),$(v,{key:0,size:"small",value:S(d),editMode:"row",dataKey:"id"},{default:x(()=>[_(a,{field:"name",header:"Nomi"},{editor:x(({data:f,field:k})=>[_(w,{modelValue:f[k],"onUpdate:modelValue":T=>f[k]=T,type:"text",size:"small",fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),_(a,{style:{width:"50px"}},{body:x(({data:f})=>[_(p,{icon:"pi pi-pencil",type:"button",onClick:k=>r(f.id),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1}),_(a,{style:{width:"50px"}},{body:x(({data:f})=>[_(p,{icon:"pi pi-trash",type:"button",onClick:k=>c(f),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1})]),_:1},8,["value"])):C("",!0)])}}});export{mt as default};
