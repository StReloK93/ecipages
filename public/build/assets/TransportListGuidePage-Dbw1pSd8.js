import{s as C,a as D,d as R,_ as S,b as E,c as I}from"./BaseForm.vue_vue_type_script_setup_true_lang-C2v4_LeH.js";import{s as Q}from"./index-CBr-MpG8.js";import{d as N,v as j,g as y,w as r,a as x,b as n,p as V,h as w,t as T,u as h,o as c,k as z,x as F,c as M,y as O}from"./app-Dqq4a65M.js";import{T as U}from"./TransportTypeRepo-Djz1Rucm.js";import{T as g}from"./TransportListRepo-HjEdcF-H.js";import"./useFetch-D45EbHv3.js";const A={class:"mb-4"},G={class:"mb-4"},K=N({__name:"FormCreateTransportList",props:{submit:{type:Function}},setup(B){const{data:u}=U.index(),b=j({name:"",name_ru:"",transport_type_id:""}),$=({values:t})=>{const l={},p={message:"To'ldiring"};return t.name||(l.name=[p]),t.name_ru||(l.name_ru=[p]),t.transport_type_id||(l.transport_type_id=[p]),{values:t,errors:l}};return(t,l)=>{const p=C,_=D,k=R;return c(),y(S,{submit:t.submit,resolver:$,initialValues:b,onClose:l[0]||(l[0]=o=>t.$emit("close"))},{default:r(o=>{var e,i,s;return[x("div",A,[n(p,{name:"name",severity:"contrast",type:"text",placeholder:"Nomi",size:"small",fluid:""}),(e=o.form.name)!=null&&e.invalid?(c(),y(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[w(T(o.form.name.error.message),1)]),_:2},1024)):V("",!0)]),x("div",G,[n(p,{name:"name_ru",type:"text",placeholder:"Nomi(ru)",size:"small",fluid:""}),(i=o.form.name_ru)!=null&&i.invalid?(c(),y(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[w(T(o.form.name_ru.error.message),1)]),_:2},1024)):V("",!0)]),x("div",null,[n(k,{size:"small",name:"transport_type_id",options:h(u)||[],optionValue:"id",optionLabel:"name",placeholder:"Transport turini tanlang",class:"w-full"},null,8,["options"]),(s=o.form.transport_type_id)!=null&&s.invalid?(c(),y(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[w(T(o.form.name_ru.error.message),1)]),_:2},1024)):V("",!0)])]}),_:1},8,["submit","initialValues"])}}}),H={class:"mb-3 text-end"},ee=N({__name:"TransportListGuidePage",setup(B){z(1);const u=z(!1),b=z([]),$=F(),{data:t}=g.index(),{data:l}=U.index();async function p(o){await new Promise((e,i)=>{g.store(o,({data:s})=>{var m;e(!0),(m=t.value)==null||m.push(s),u.value=!1})})}const _=o=>{$.require({message:`(${o.name}) - Aniq o'chirmoqchimisiz?`,header:"O'chirish",rejectProps:{label:"Bekor qilish",severity:"secondary",outlined:!0},acceptProps:{label:"O'chirish",severity:"danger"},accept:()=>{g.destroy(o.id,()=>{var i,s;const e=(i=t.value)==null?void 0:i.findIndex(m=>m.id==o.id);e>-1&&((s=t.value)==null||s.splice(e,1))})}})};function k(o){let{newData:e,index:i}=o;g.update(e.id,e,({data:s})=>{var m;(m=t.value)!=null&&m.length&&(t.value[i].name=s.name,t.value[i].name_ru=s.name_ru,t.value[i].transport_type_id=s.transport_type_id,t.value[i].transport_type=s.transport_type)})}return(o,e)=>{const i=O,s=Q,m=C,v=E,L=R,q=I;return c(),M("div",null,[x("main",H,[n(i,{icon:"pi pi-plus",label:"Qo'shish",size:"small",severity:"contrast",onClick:e[0]||(e[0]=a=>u.value=!0)}),n(s,{header:"Qurilma modeli qo'shish","show-close-icon":!1,visible:u.value,"onUpdate:visible":e[2]||(e[2]=a=>u.value=a),position:"right"},{default:r(()=>[n(K,{onClose:e[1]||(e[1]=a=>u.value=!1),submit:p})]),_:1},8,["visible"])]),h(l)&&h(t)?(c(),y(q,{key:0,size:"small",editingRows:b.value,"onUpdate:editingRows":e[3]||(e[3]=a=>b.value=a),value:h(t),editMode:"row",dataKey:"id",onRowEditSave:k},{default:r(()=>[n(v,{field:"name",header:"Nomi"},{editor:r(({data:a,field:d})=>[n(m,{modelValue:a[d],"onUpdate:modelValue":f=>a[d]=f,type:"text",size:"small",fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(v,{field:"name_ru",header:"Nomi (ru)"},{editor:r(({data:a,field:d})=>[n(m,{modelValue:a[d],"onUpdate:modelValue":f=>a[d]=f,type:"text",size:"small",fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(v,{field:"transport_type_id",header:"Qurilma turi"},{editor:r(({data:a,field:d})=>[n(L,{modelValue:a[d],"onUpdate:modelValue":f=>a[d]=f,size:"small",options:h(l),optionValue:"id",optionLabel:"name",placeholder:"Transport turini tanlang"},null,8,["modelValue","onUpdate:modelValue","options"])]),body:r(({data:a,field:d})=>[w(T(a.transport_type.name),1)]),_:1}),n(v,{rowEditor:!0,style:{width:"120px"},bodyStyle:"text-align:right"}),n(v,{style:{width:"50px"}},{body:r(({data:a})=>[n(i,{icon:"pi pi-trash",type:"button",onClick:d=>_(a),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1})]),_:1},8,["editingRows","value"])):V("",!0)])}}});export{ee as default};
