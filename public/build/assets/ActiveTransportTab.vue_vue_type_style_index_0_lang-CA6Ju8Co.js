import{s as X}from"./index-CA7nLu6_.js";import{n as Y,B as Z,s as ee,p as te,q as re,c as r,l as j,e as t,v as N,h as z,x as I,y as U,t as y,d as q,i as _,j as M,z as oe,F as x,r as C,A as B,a as o,w as O,C as P,b as L,D as A,E as se,u as G,o as H,m as Q,G as ae,_ as ne,H as ie}from"./app-FLo-CGDf.js";import{s as J,_ as le}from"./SmenaViewer.vue_vue_type_script_setup_true_lang-ki8Fe2RJ.js";import{s as ce,a as de}from"./index-CSY6dRb9.js";import{s as pe}from"./index-CtePozXX.js";import{T as ue}from"./TransportListRepo-Dhj0avhJ.js";import{C as me}from"./ChangeRepo-ClCV1WeP.js";var he=Y`
    .p-chip {
        display: inline-flex;
        align-items: center;
        background: dt('chip.background');
        color: dt('chip.color');
        border-radius: dt('chip.border.radius');
        padding-block: dt('chip.padding.y');
        padding-inline: dt('chip.padding.x');
        gap: dt('chip.gap');
    }

    .p-chip-icon {
        color: dt('chip.icon.color');
        font-size: dt('chip.icon.font.size');
        width: dt('chip.icon.size');
        height: dt('chip.icon.size');
    }

    .p-chip-image {
        border-radius: 50%;
        width: dt('chip.image.width');
        height: dt('chip.image.height');
        margin-inline-start: calc(-1 * dt('chip.padding.y'));
    }

    .p-chip:has(.p-chip-remove-icon) {
        padding-inline-end: dt('chip.padding.y');
    }

    .p-chip:has(.p-chip-image) {
        padding-block-start: calc(dt('chip.padding.y') / 2);
        padding-block-end: calc(dt('chip.padding.y') / 2);
    }

    .p-chip-remove-icon {
        cursor: pointer;
        font-size: dt('chip.remove.icon.size');
        width: dt('chip.remove.icon.size');
        height: dt('chip.remove.icon.size');
        color: dt('chip.remove.icon.color');
        border-radius: 50%;
        transition:
            outline-color dt('chip.transition.duration'),
            box-shadow dt('chip.transition.duration');
        outline-color: transparent;
    }

    .p-chip-remove-icon:focus-visible {
        box-shadow: dt('chip.remove.icon.focus.ring.shadow');
        outline: dt('chip.remove.icon.focus.ring.width') dt('chip.remove.icon.focus.ring.style') dt('chip.remove.icon.focus.ring.color');
        outline-offset: dt('chip.remove.icon.focus.ring.offset');
    }
`,fe={root:"p-chip p-component",image:"p-chip-image",icon:"p-chip-icon",label:"p-chip-label",removeIcon:"p-chip-remove-icon"},ve=Z.extend({name:"chip",style:he,classes:fe}),ge={name:"BaseChip",extends:te,props:{label:{type:[String,Number],default:null},icon:{type:String,default:null},image:{type:String,default:null},removable:{type:Boolean,default:!1},removeIcon:{type:String,default:void 0}},style:ve,provide:function(){return{$pcChip:this,$parentInstance:this}}},W={name:"Chip",extends:ge,inheritAttrs:!1,emits:["remove"],data:function(){return{visible:!0}},methods:{onKeydown:function(a){(a.key==="Enter"||a.key==="Backspace")&&this.close(a)},close:function(a){this.visible=!1,this.$emit("remove",a)}},computed:{dataP:function(){return re({removable:this.removable})}},components:{TimesCircleIcon:ee}},be=["aria-label","data-p"],ye=["src"];function _e(e,a,p,u,m,n){return m.visible?(t(),r("div",I({key:0,class:e.cx("root"),"aria-label":e.label},e.ptmi("root"),{"data-p":n.dataP}),[N(e.$slots,"default",{},function(){return[e.image?(t(),r("img",I({key:0,src:e.image},e.ptm("image"),{class:e.cx("image")}),null,16,ye)):e.$slots.icon?(t(),z(U(e.$slots.icon),I({key:1,class:e.cx("icon")},e.ptm("icon")),null,16,["class"])):e.icon?(t(),r("span",I({key:2,class:[e.cx("icon"),e.icon]},e.ptm("icon")),null,16)):j("",!0),e.label?(t(),r("div",I({key:3,class:e.cx("label")},e.ptm("label")),y(e.label),17)):j("",!0)]}),e.removable?N(e.$slots,"removeicon",{key:0,removeCallback:n.close,keydownCallback:n.onKeydown},function(){return[(t(),z(U(e.removeIcon?"span":"TimesCircleIcon"),I({class:[e.cx("removeIcon"),e.removeIcon],onClick:n.close,onKeydown:n.onKeydown},e.ptm("removeIcon")),null,16,["class","onClick","onKeydown"]))]}):j("",!0)],16,be)):j("",!0)}W.render=_e;const xe={class:"flex gap-4 flex-col"},ke={key:1},we={class:"max-h-90 overflow-y-auto flex flex-col gap-2"},$e=["draggable","onDragstart"],Ce={class:"font-medium text-gray-700 leading-4"},Te={class:"block"},De={class:"text-slate-500 text-sm"},Se=q({__name:"DragBlockUser",props:{list:{},groupLavozims:{}},emits:["dragstart"],setup(e,{emit:a}){const p=_(""),u=a,m=e,n=M(),E=oe(()=>m.list.employes.filter(k=>k.name.toLowerCase().includes(p.value.toLowerCase())));return(k,w)=>{const T=J,h=de,c=pe,g=ce;return t(),r("div",xe,[k.groupLavozims==null?(t(),r(x,{key:0},C(6,d=>B(T,{height:"42px",width:"100%","border-radius":"24px"})),64)):(t(),r("section",ke,[B(g,{class:"mb-4"},{default:O(()=>[B(h,{class:"pi pi-search"}),B(c,{modelValue:p.value,"onUpdate:modelValue":w[0]||(w[0]=d=>p.value=d),placeholder:"Qidiruv",fluid:"",class:"rounded-xl! border border-surface-100! shadow-none! bg-zinc-50!"},null,8,["modelValue"])]),_:1}),o("main",we,[(t(!0),r(x,null,C(E.value,d=>(t(),r("div",{key:d.id,draggable:!L(n).isAdmin,onDragstart:D=>u("dragstart",D,d),class:P([[L(n).isAdmin?"cursor-default":"cursor-grab active:cursor-grabbing"],"select-none rounded-xl py-2 px-4 bg-zinc-50 border border-surface-100 hover:bg-blue-300/10 hover:border-blue-300 transition-all flex items-center gap-3"])},[o("div",Ce,[o("span",Te,y(d.name),1),o("span",De," Razryad: "+y(d.razryad),1)]),w[1]||(w[1]=o("i",{class:"pi pi-clone ml-auto text-sky-600 text-sm mr-2"},null,-1))],42,$e))),128))])]))])}}}),V="groups",K={index(){return A.get(`${V}`)},byTransport(e){return A.get(`${V}/transport/${e}`)},show(e){return A.get(`${V}/${e}`)},async store(e){return await A.post(`${V}`,e)},update(e,a){return A.put(`${V}/${e}`,a)},destroy(e){return A.delete(`${V}/${e}`)}},Be={class:"font-sans"},ze={class:"mb-2 text-xl text-right text-blue-600"},Le={class:"text-base"},Ie={class:"flex gap-5"},Ae={class:"w-1/4 rounded-xl h-fit"},Ve={class:"w-3/4 grid grid-cols-1 gap-4"},je={class:"flex justify-between items-center border-b border-gray-200 py-3 px-4"},Ee={class:"font-semibold text-gray-600 text-sm"},Re={class:"flex flex-grow"},qe=["onDragover","onDrop"],Fe={class:"absolute -top-1 right-2"},Ke={key:1,class:"w-6 h-6 rounded-full bg-blue-100 text-blue-600 inline-flex items-center justify-center text-sm"},Ne={class:"flex flex-wrap gap-2 px-3 py-4 items-start animate-pop-in"},Pe=q({__name:"DragBlock",props:{list:{},lavozims:{},transport:{},changes:{}},setup(e){const a=M(),p=_(null),u=se(),m=_(),n=e,{execute:E,data:k}=G(K.byTransport);function w(i){const s=n.changes.find(f=>f.id==i);return s?s.name:null}const T=new Set(Object.values(n.transport.smena.formula.first)),h=_(null),c=_(null),g=(i,s)=>{h.value=s,i.dataTransfer&&(i.dataTransfer.effectAllowed="copy",i.dataTransfer.setData("text/plain",JSON.stringify(s)))},d=(i,s)=>{m.value!=s&&(m.value=s)},D=async(i,s,f)=>{var l,v;m.value=null;const S={transport_id:n.transport.id,change_id:f,employe_id:(l=h.value)==null?void 0:l.id,lavozim_id:s.id};if(h.value){if(s[f].some($=>{var F;return $.employe.id===((F=h.value)==null?void 0:F.id)}))return u.add({severity:"warn",summary:"Takrorlamang!",detail:`${(v=h.value)==null?void 0:v.name} bu smenada  mavjud.`,life:5e3});p.value=s[f],await K.store(S).then($=>{s[f].push($.data)}).catch(()=>{var $;u.add({severity:"error",summary:`${($=h.value)==null?void 0:$.name} bu smenada  mavjud.`,detail:"Bir kishi bir smenada ikki lavozimda ishlay olmaydi!",life:5e3})}).finally(()=>{p.value=null}),h.value=null}},R=(i,s,f)=>{K.destroy(i).then(S=>{s.splice(f,1)})};return H(async()=>{await E(n.transport.id),c.value=n.lavozims.map(i=>(T.forEach(s=>{var S;const f=(S=k.value)==null?void 0:S.filter(l=>l.change_id==s&&l.lavozim_id==i.id&&l.transport_id==n.transport.id);i[s]=[],f==null||f.forEach(l=>{i[s].push(l)})}),i))}),(i,s)=>{const f=J,S=W;return t(),r("div",Be,[o("h3",ze,[Q(y(i.transport.garage_number)+" - ",1),o("span",Le,y(i.list.name),1)]),o("div",Ie,[o("div",Ae,[B(Se,{groupLavozims:c.value,list:n.list,onDragstart:g},null,8,["groupLavozims","list"])]),o("div",Ve,[c.value==null?(t(),r(x,{key:0},C(2,l=>B(f,{"border-radius":"12px",height:"208px",width:"100%"})),64)):(t(!0),r(x,{key:1},C(c.value,l=>(t(),r("div",{key:l.id,class:"min-h-52 border border-gray-200 rounded-xl flex flex-col bg-white"},[o("div",je,[o("span",Ee,y(l.name),1)]),o("main",Re,[(t(!0),r(x,null,C(L(T),v=>(t(),r("div",{onDragover:ae(b=>d(b,l[v]),["prevent"]),onDragleave:s[0]||(s[0]=b=>m.value=null),onDrop:b=>D(b,l,v),class:P([{"bg-surface-50":m.value==l[v]},"basis-0 flex-grow border-l first:border-0 border-surface-100 h-full relative transition-all"])},[o("span",Fe,[p.value==l[v]?(t(),z(f,{key:0,shape:"circle",height:"24px",width:"24px"})):(t(),r("span",Ke,y(w(v)),1))]),o("div",Ne,[(t(!0),r(x,null,C(l[v],(b,$)=>(t(),z(S,{onRemove:F=>R(b.id,l[v],$),key:b,label:b.employe.name,class:"text-xs! animate-pop-in",removable:!L(a).isAdmin},null,8,["onRemove","label","removable"]))),128))])],42,qe))),256))])]))),128))])])])}}}),Ue=ne(Pe,[["__scopeId","data-v-3b363061"]]),Me=q({__name:"TabButton",props:{active:{type:Boolean},direction:{default:"bottom"}},setup(e){const a=e,p={left:{border:"border-l hover:border-l-gray-500 dark:hover:border-l-gray-300",active:"!border-l-gray-500 dark:!border-l-gray-300",different:"right-px"},right:{border:"border-r hover:border-r-gray-500 dark:hover:border-r-gray-300",active:"!border-r-gray-500 dark:!border-r-gray-300",different:"left-0"},top:{border:"border-t hover:border-t-gray-500 dark:hover:border-t-gray-300",active:"!border-t-gray-500 dark:!border-t-gray-300",different:"bottom-px"},bottom:{border:"border-b hover:border-b-gray-500 dark:hover:border-b-gray-300",active:"!border-b-gray-600 dark:!border-b-gray-300",different:"top-px"}};return(u,m)=>(t(),r("button",{class:P(["py-1 text-sm px-3 border-transparent cursor-pointer relative",[{"font-semibold":a.active},{[p[a.direction].active]:a.active},p[a.direction].border,p[a.direction].different]])},[N(u.$slots,"default")],2))}}),Oe={class:"flex w-full"},Ge={class:"min-w-48 relative z-50 the-shadow"},He={class:"absolute inset-0 overflow-y-auto overflow-x-hidden h-full flex flex-col gap-1 py-10 scroll-left"},Qe={class:"font-semibold text-[16px]"},Je={class:"p-8 flex-grow bg-white border border-gray-100 rounded-4xl min-h-154 shadow-xs"},We={key:0,class:"flex items-center justify-center h-full"},Xe={key:1,class:"flex items-center justify-center h-full"},Ye={key:2},nt=q({__name:"ActiveTransportTab",props:{transport_type:{}},setup(e){const a=e,p=_([]),u=_(null),m=_(null),n=_(0),{execute:E,data:k,isFirstLoading:w}=G(me.index);async function T(h,c){m.value=null,u.value=null,await ie(),u.value=h,m.value=c}return H(async()=>{const{data:h}=await ue.byTransportType(a.transport_type.id);await E(),p.value=h;let c=null,g=null;for(const d of h)if(d.transports.length>0){c=d.transports[0],g=d;break}g&&c&&T(c,g)}),(h,c)=>{const g=X;return t(),r("section",Oe,[o("nav",Ge,[o("main",He,[(t(!0),r(x,null,C(p.value,d=>(t(),r(x,null,[(t(!0),r(x,null,C(d.transports,D=>{var R;return t(),z(Me,{class:"w-full text-left",direction:"right",onClick:i=>T(D,d),active:((R=u.value)==null?void 0:R.id)==D.id,onVnodeMounted:c[0]||(c[0]=i=>n.value++)},{default:O(()=>[Q(y(d.name)+" - ",1),o("span",Qe,y(D.garage_number),1)]),_:2},1032,["onClick","active"])}),256))],64))),256))])]),o("aside",Je,[L(w)?(t(),r("main",We,[B(g)])):n.value==0?(t(),r("main",Xe,c[1]||(c[1]=[o("div",{class:"w-120 text-center"},[o("h3",{class:"text-gray-800 text-2xl mb-1 font-semibold"},"Qurilmalar kiritilmagan"),o("p",{class:"text-gray-500"}," Hozirda ushbu transport turiga hech qanday qurilma kiritilmagan. Iltimos, avval transport turlariga mos qurilmalarni qo'shing. ")],-1)]))):(t(),r("main",Ye,[m.value&&u.value&&L(k)?(t(),z(Ue,{key:0,class:"mb-4",changes:L(k),list:m.value,lavozims:a.transport_type.lavozims,transport:u.value},null,8,["changes","list","lavozims","transport"])):j("",!0),o("main",null,[u.value?(t(),z(le,{key:0,transport:u.value},null,8,["transport"])):j("",!0)])]))])])}}});export{Me as _,nt as a};
