import{b as se,s as X,a as ae,c as ie}from"./index-B8-WGO63.js";import{c as W,f as z}from"./index-BGY1eZ2G.js";import{B as ue,s as de,g as C,l as q,f as g,w as x,m as D,j as ce,x as me,a5 as pe,a6 as fe,a7 as Y,a8 as V,u as N,d as A,a9 as ve,q as S,aa as be,c as $,a as l,i as T,t as j,F as O,r as k,k as h,y as Z,L as ee,v as te,o as ye,M as he,z as ge}from"./app-C4GmJSBZ.js";import{C as ne}from"./ChangeRepo-Cv2ole86.js";var we={root:"p-formfield p-component"},_e=ue.extend({name:"formfield",classes:we}),xe={name:"BaseFormField",extends:de,style:_e,props:{name:{type:String,default:void 0},resolver:{type:Function,default:void 0},initialValue:{type:null,default:void 0},validateOnValueUpdate:{type:Boolean,default:void 0},validateOnBlur:{type:Boolean,default:void 0},validateOnMount:{type:Boolean,default:void 0},validateOnSubmit:{type:Boolean,default:void 0},as:{type:[String,Object],default:"DIV"},asChild:{type:Boolean,default:!1}},provide:function(){return{$pcFormField:this,$parentInstance:this}}};function M(e){"@babel/helpers - typeof";return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(e)}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Q(Object(n),!0).forEach(function(r){$e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $e(e,t,n){return(t=Se(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Se(e){var t=Ve(e,"string");return M(t)=="symbol"?t:t+""}function Ve(e,t){if(M(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(M(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G={name:"FormField",extends:xe,inheritAttrs:!1,inject:{$pcForm:{default:void 0}},watch:{formControl:{immediate:!0,handler:function(t){var n,r;(n=this.$pcForm)===null||n===void 0||(r=n.register)===null||r===void 0||r.call(n,this.name,t)}}},computed:{formControl:function(){return{name:this.name,resolver:this.resolver,initialValue:this.initialValue,validateOnValueUpdate:this.validateOnValueUpdate,validateOnBlur:this.validateOnBlur,validateOnMount:this.validateOnMount,validateOnSubmit:this.validateOnSubmit}},field:function(){var t;return((t=this.$pcForm)===null||t===void 0||(t=t.fields)===null||t===void 0?void 0:t[this.name])||{}},fieldAttrs:function(){return H(H({},this.field.props),this.field.states)}}};function Oe(e,t,n,r,d,s){return e.asChild?q(e.$slots,"default",D({key:1,class:e.cx("root"),props:s.field.props},s.fieldAttrs)):(g(),C(ce(e.as),D({key:0,class:e.cx("root")},e.ptmi("root")),{default:x(function(){return[q(e.$slots,"default",D({props:s.field.props},s.fieldAttrs))]}),_:3},16,["class"]))}G.render=Oe;function ke(e){return pe()?(fe(e),!0):!1}const oe=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ce=Object.prototype.toString,Fe=e=>Ce.call(e)==="[object Object]",F=()=>{},je=Pe();function Pe(){var e,t;return oe&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window==null?void 0:window.navigator)==null?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function R(e){return Array.isArray(e)?e:[e]}function Be(e,t,n){return me(e,t,{...n,immediate:!0})}const re=oe?window:void 0;function B(e){var t;const n=V(e);return(t=n==null?void 0:n.$el)!=null?t:n}function L(...e){const t=[],n=()=>{t.forEach(o=>o()),t.length=0},r=(o,a,p,f)=>(o.addEventListener(a,p,f),()=>o.removeEventListener(a,p,f)),d=Y(()=>{const o=R(V(e[0])).filter(a=>a!=null);return o.every(a=>typeof a!="string")?o:void 0}),s=Be(()=>{var o,a;return[(a=(o=d.value)==null?void 0:o.map(p=>B(p)))!=null?a:[re].filter(p=>p!=null),R(V(d.value?e[1]:e[0])),R(N(d.value?e[2]:e[1])),V(d.value?e[3]:e[2])]},([o,a,p,f])=>{if(n(),!(o!=null&&o.length)||!(a!=null&&a.length)||!(p!=null&&p.length))return;const c=Fe(f)?{...f}:f;t.push(...o.flatMap(b=>a.flatMap(v=>p.map(y=>r(b,v,y,c)))))},{flush:"post"}),m=()=>{s(),n()};return ke(n),m}let J=!1;function Ee(e,t,n={}){const{window:r=re,ignore:d=[],capture:s=!0,detectIframe:m=!1,controls:o=!1}=n;if(!r)return o?{stop:F,cancel:F,trigger:F}:F;if(je&&!J){J=!0;const u={passive:!0};Array.from(r.document.body.children).forEach(i=>i.addEventListener("click",F,u)),r.document.documentElement.addEventListener("click",F,u)}let a=!0;const p=u=>V(d).some(i=>{if(typeof i=="string")return Array.from(r.document.querySelectorAll(i)).some(w=>w===u.target||u.composedPath().includes(w));{const w=B(i);return w&&(u.target===w||u.composedPath().includes(w))}});function f(u){const i=V(u);return i&&i.$.subTree.shapeFlag===16}function c(u,i){const w=V(u),P=w.$.subTree&&w.$.subTree.children;return P==null||!Array.isArray(P)?!1:P.some(K=>K.el===i.target||i.composedPath().includes(K.el))}const b=u=>{const i=B(e);if(u.target!=null&&!(!(i instanceof Element)&&f(e)&&c(e,u))&&!(!i||i===u.target||u.composedPath().includes(i))){if("detail"in u&&u.detail===0&&(a=!p(u)),!a){a=!0;return}t(u)}};let v=!1;const y=[L(r,"click",u=>{v||(v=!0,setTimeout(()=>{v=!1},0),b(u))},{passive:!0,capture:s}),L(r,"pointerdown",u=>{const i=B(e);a=!p(u)&&!!(i&&!u.composedPath().includes(i))},{passive:!0}),m&&L(r,"blur",u=>{setTimeout(()=>{var i;const w=B(e);((i=r.document.activeElement)==null?void 0:i.tagName)==="IFRAME"&&!(w!=null&&w.contains(r.document.activeElement))&&t(u)},0)},{passive:!0})].filter(Boolean),_=()=>y.forEach(u=>u());return o?{stop:_,cancel:()=>{a=!1},trigger:u=>{a=!0,b(u),a=!1}}:_}const Me={key:0,class:"absolute top-full bg-white w-full border border-transparent translate-y-px z-[100]"},ze=["onClick"],U=A({__name:"MiniSelect",props:ve({data:{},name:{},value:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=S(),n=be(e,"modelValue"),r=S(!1),d=e;Ee(t,o=>r.value=!1);const s=Y(()=>d.data.find(o=>(d.value?o[d.value]:o)==n.value));function m(o){o?n.value=d.value?o[d.value]:o:n.value=void 0,r.value=!1}return(o,a)=>(g(),$("section",{ref_key:"miniSelect",ref:t,class:"relative w-6 h-6 text-sm"},[l("button",{type:"button",onClick:a[0]||(a[0]=p=>r.value=!0),class:"cursor-pointer bg-white text-center w-full h-full"},j(d.name&&s.value?s.value[d.name]:s.value),1),r.value?(g(),$("nav",Me,[l("div",null,[l("button",{type:"button",onClick:a[1]||(a[1]=p=>m(void 0)),class:"w-full h-full text-center border border-transparent border-y-2 border-y-white bg-zinc-100 hover:bg-zinc-200 cursor-pointer"},a[2]||(a[2]=[l("span",{class:"p-button-icon pi pi-times !text-[10px] text-red-500"},null,-1)])),(g(!0),$(O,null,k(d.data,p=>(g(),$("button",{type:"button",onClick:f=>m(p),class:"w-full text-center border border-transparent border-b-2 last:border-b-0 border-b-white bg-zinc-100 hover:bg-zinc-200 cursor-pointer"},j(d.name?p[d.name]:p),9,ze))),256))])])):T("",!0)],512))}}),Ae={class:"flex flex-col"},Ie={class:"flex gap-3"},le=A({__name:"OldBaseForm",props:{initialValues:{},resolver:{},submit:{type:Function}},setup(e,{expose:t}){const n=S(),r=S(!1),d=e,s=async({valid:m,values:o})=>{m&&(r.value=!0,await d.submit(o).finally(()=>{r.value=!1}))};return t({instance:n}),(m,o)=>{const a=Z,p=se;return g(),C(p,{ref_key:"instance",ref:n,initialValues:m.initialValues,resolver:m.resolver,onSubmit:s,class:"flex flex-col gap-4 w-full"},{default:x(f=>[l("div",Ae,[q(m.$slots,"default",{form:f})]),o[1]||(o[1]=l("div",{class:"flex-grow"},null,-1)),l("main",Ie,[h(a,{type:"button",size:"small",severity:"secondary",onClick:o[0]||(o[0]=c=>m.$emit("close")),label:"Bekor qilish",fluid:!0}),h(a,{type:"submit",size:"small",severity:"contrast",label:"Saqlash",fluid:!0,loading:r.value},null,8,["loading"])])]),_:3,__:[1]},8,["initialValues","resolver"])}}}),Ue={class:"mb-4 h-full"},Te={class:"mb-10"},De={class:"border border-white bg-gray-50 w-7 h-7 text-center content-center"},Re={class:"text-sm leading-1"},Le={class:"border border-white bg-gray-50 w-7 h-7 text-center"},qe={class:"border border-white bg-gray-50 w-7 h-7 text-center"},Ne={class:"h-full w-full flex items-center justify-center border border-gray-200"},We={class:"mb-4"},Ge=A({__name:"SmenaCreate",props:{submit:{type:Function}},setup(e){const t=S([]);ne.index(({data:d})=>{t.value=d});const n=ee({name:"",formula:{first:{},second:{}}}),r=({values:d})=>{const s={},m="To'ldiring";return d.name||(s.name=[m]),{values:d,errors:s}};return(d,s)=>{const m=G,o=W,a=X;return g(),C(le,{class:"h-full",submit:d.submit,resolver:r,initialValues:n,onClose:s[1]||(s[1]=p=>d.$emit("close"))},{default:x(p=>{var f;return[l("div",Ue,[h(m,{name:"formula"},{default:x(c=>[l("table",Te,[l("tr",null,[s[2]||(s[2]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},null,-1)),(g(),$(O,null,k(30,b=>l("td",De,[l("span",Re,j(b),1)])),64))]),l("tr",null,[s[3]||(s[3]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[l("span",{class:"p-button-icon pi pi-sun text-orange-400"})],-1)),(g(),$(O,null,k(30,b=>l("td",Le,[l("div",{onClick:s[0]||(s[0]=()=>{}),class:"h-full w-full flex items-center justify-center border border-gray-200"},[h(U,{modelValue:c.value.first[b],"onUpdate:modelValue":v=>c.value.first[b]=v,name:"name",value:"id",data:t.value},null,8,["modelValue","onUpdate:modelValue","data"])])])),64))]),l("tr",null,[s[4]||(s[4]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[l("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"})],-1)),(g(),$(O,null,k(30,b=>l("td",qe,[l("div",Ne,[h(U,{modelValue:c.value.second[b],"onUpdate:modelValue":v=>c.value.second[b]=v,name:"name",value:"id",data:t.value},null,8,["modelValue","onUpdate:modelValue","data"])])])),64))])])]),_:1}),s[5]||(s[5]=l("div",{class:"flex-grow"},null,-1)),l("div",We,[h(o,{placeholder:"Smena turi nomi",name:"name",size:"small",inputId:"integeronly",fluid:""}),(f=p.form.name)!=null&&f.invalid?(g(),C(a,{key:0,severity:"error",size:"small",variant:"simple"},{default:x(()=>[te(j(p.form.name.error),1)]),_:2},1024)):T("",!0)])])]}),_:1},8,["submit","initialValues"])}}}),I="smena";function Ke(){return z({url:`${I}`})}function Qe(e,t){return z({url:`${I}/${e}`,onLoad:t})}function He(e,t,n){return z({url:`${I}/${e}`,method:"put",formData:t,onLoad:n})}function Je(e,t){return z({url:`${I}`,method:"post",formData:e,onLoad:t})}function Xe(e,t){return z({url:`${I}/${e}`,method:"delete",onLoad:t})}const E={index:Ke,update:He,store:Je,destroy:Xe,show:Qe},Ye={class:"mb-4 h-full"},Ze={class:"mb-10"},et={class:"border border-white bg-gray-50 w-7 h-7 text-center content-center"},tt={class:"text-sm leading-1"},nt={class:"border border-white bg-gray-50 w-7 h-7 text-center"},ot={class:"h-full w-full flex items-center justify-center border border-gray-200"},rt={class:"border border-white bg-gray-50 w-7 h-7 text-center"},lt={class:"h-full w-full flex items-center justify-center border border-gray-200"},st={class:"mb-4"},at=A({__name:"SmenaUpdate",props:{submit:{type:Function},smena_id:{}},setup(e){const t=S(null),n=e,r=S([]);ne.index(({data:m})=>{r.value=m});const d=ee({name:"",formula:{first:{},second:{}}}),s=({values:m})=>{const o={},a="To'ldiring";return m.name||(o.name=[a]),{values:m,errors:o}};return ye(()=>{n.smena_id&&E.show(n.smena_id,({data:m})=>{t.value&&(t.value.instance.setFieldValue("name",m.name),t.value.instance.setFieldValue("formula",m.formula))})}),(m,o)=>{const a=G,p=W,f=X;return g(),C(le,{ref_key:"form",ref:t,class:"h-full",submit:m.submit,resolver:s,initialValues:d,onClose:o[0]||(o[0]=c=>m.$emit("close"))},{default:x(c=>{var b;return[l("div",Ye,[h(a,{name:"formula"},{default:x(v=>[l("table",Ze,[l("tbody",null,[l("tr",null,[o[1]||(o[1]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},null,-1)),(g(),$(O,null,k(30,y=>l("td",et,[l("span",tt,j(y),1)])),64))]),l("tr",null,[o[2]||(o[2]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[l("span",{class:"p-button-icon pi pi-sun text-orange-400"})],-1)),(g(),$(O,null,k(30,y=>l("td",nt,[l("div",ot,[h(U,{modelValue:v.value.first[y],"onUpdate:modelValue":_=>v.value.first[y]=_,name:"name",value:"id",data:r.value},null,8,["modelValue","onUpdate:modelValue","data"])])])),64))]),l("tr",null,[o[3]||(o[3]=l("td",{class:"border border-white bg-gray-50 w-7 h-7 text-center"},[l("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"})],-1)),(g(),$(O,null,k(30,y=>l("td",rt,[l("div",lt,[h(U,{modelValue:v.value.second[y],"onUpdate:modelValue":_=>v.value.second[y]=_,name:"name",value:"id",data:r.value},null,8,["modelValue","onUpdate:modelValue","data"])])])),64))])])])]),_:1}),o[4]||(o[4]=l("div",{class:"flex-grow"},null,-1)),l("div",st,[h(p,{placeholder:"Smena turi nomi",name:"name",size:"small",inputId:"integeronly",fluid:""}),(b=c.form.name)!=null&&b.invalid?(g(),C(f,{key:0,severity:"error",size:"small",variant:"simple"},{default:x(()=>[te(j(c.form.name.error),1)]),_:2},1024)):T("",!0)])])]}),_:1},8,["submit","initialValues"])}}}),it={class:"mb-3 text-end"},pt=A({__name:"SmenaGuidePage",setup(e){const t=S(null),n=S(!1),r=S(!1),d=he(),{data:s}=E.index();async function m(f){await new Promise((c,b)=>{E.store(f,({data:v})=>{var y;c(!0),(y=s.value)==null||y.push(v),n.value=!1})})}function o(f){t.value=f,r.value=!0}const a=f=>{d.require({message:`(${f.name}) - Aniq o'chirmoqchimisiz?`,header:"O'chirish",rejectProps:{label:"Bekor qilish",severity:"secondary",outlined:!0},acceptProps:{label:"O'chirish",severity:"danger"},accept:()=>{E.destroy(f.id||0,()=>{var b,v;const c=(b=s.value)==null?void 0:b.findIndex(y=>y.id==f.id);c>-1&&((v=s.value)==null||v.splice(c,1))})}})};async function p(f){await new Promise((c,b)=>{t.value&&s.value&&E.update(t.value,f,v=>{var u;const y=(u=s.value)==null?void 0:u.findIndex(i=>i.id==t.value);let _=s.value;_&&_[y]&&(_[y].name=v.data.name),r.value=!1,c(v)})})}return(f,c)=>{const b=Z,v=ge,y=W,_=ae,u=ie;return g(),$("div",null,[l("main",it,[h(b,{icon:"pi pi-plus",label:"Qo'shish",size:"small",severity:"contrast",onClick:c[0]||(c[0]=i=>n.value=!0)}),h(v,{visible:n.value,"onUpdate:visible":c[2]||(c[2]=i=>n.value=i),maximizable:"",modal:"",header:"Smena turi",breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:x(()=>[h(Ge,{onClose:c[1]||(c[1]=i=>n.value=!1),submit:m})]),_:1},8,["visible"]),h(v,{visible:r.value,"onUpdate:visible":c[4]||(c[4]=i=>r.value=i),maximizable:"",modal:"",header:"Smena turi",breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:x(()=>[h(at,{smena_id:t.value,onClose:c[3]||(c[3]=i=>r.value=!1),submit:p},null,8,["smena_id"])]),_:1},8,["visible"])]),N(s)?(g(),C(u,{key:0,size:"small",value:N(s),editMode:"row",dataKey:"id"},{default:x(()=>[h(_,{field:"name",header:"Nomi"},{editor:x(({data:i,field:w})=>[h(y,{modelValue:i[w],"onUpdate:modelValue":P=>i[w]=P,type:"text",size:"small",fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),h(_,{style:{width:"50px"}},{body:x(({data:i})=>[h(b,{icon:"pi pi-pencil",type:"button",onClick:w=>o(i.id),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1}),h(_,{style:{width:"50px"}},{body:x(({data:i})=>[h(b,{icon:"pi pi-trash",type:"button",onClick:w=>a(i),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1})]),_:1},8,["value"])):T("",!0)])}}});export{pt as default};
