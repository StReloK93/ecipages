import{s as T}from"./index-B8t7bGv7.js";import{d as j}from"./PrimeInputs-DmhZj6qO.js";import{C as N}from"./ChangeRepo-BONP7Fl7.js";import{u as z}from"./index-DI2rPmbe.js";import{d as I,q as M,o as O,c,a as n,C as k,F as y,r as h,w as A,y as E,f as i,v as _,t as g}from"./app-Fni99Aas.js";const L={key:0,class:"h-full"},P={class:"mb-4 text-right"},R={class:"bg-white p-5 rounded-2xl border border-surface-100"},U={class:"w-full table-fixed"},Y={class:"text-sm leading-1"},$={class:"aspect-square w-full flex items-center justify-center border border-transparent"},G={class:"aspect-square w-full flex items-center justify-center border-transparent"},H={key:1,class:"pt-2"},tt=I({__name:"SmenaViewer",props:{transport:{}},setup(S){const a=S,b=M(new Date),m=M();function x(o){var r;const t=(r=C.value)==null?void 0:r.find(s=>s.id==o);return t||null}const{data:C,execute:V}=z(N.index);function D(o){m.value=B(o)}function q(o,t){const s=t.getTime()-o.getTime();return Math.round(s/864e5)}function B(o){if(a.transport.smena==null||a.transport.start_smena_day==null)return;const t=a.transport.start_smena_day?new Date(a.transport.start_smena_day):null,r=Object.keys(a.transport.smena.formula.first).length,s=o.getFullYear(),e=o.getMonth(),l=[],v=[],F=new Date(s,e+1,0).getDate();for(let d=1;d<=F;d++){const f=new Date(s,e,d);if(q(t,f)%r==0){if(l.push({date:f,number:1,startSmena:!0}),d<=r)for(let u=r-1;u>0;u--){const p=r-u,w=new Date(s,e,d-p);f.getMonth()==w.getMonth()&&v.unshift({date:w,number:u+1})}for(let u=1;u<r;u++){const p=new Date(s,e,d+u);f.getMonth()==p.getMonth()&&l.push({date:p,number:u+1})}}}return v.concat(l)}return O(async()=>{await V(),D(b.value)}),(o,t)=>{const r=j,s=T;return a.transport.smena&&a.transport.start_smena_day?(i(),c("div",L,[n("nav",P,[k(r,{modelValue:b.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>b.value=e),D],view:"month",class:"p-0!",dateFormat:"yy-mm",size:"small"},null,8,["modelValue"])]),n("main",R,[n("table",U,[n("tbody",null,[n("tr",null,[t[1]||(t[1]=n("td",{class:"aspect-square text-center"},null,-1)),(i(!0),c(y,null,h(m.value,e=>(i(),c("td",{class:_(["aspect-square text-center content-center",{"border-l-surface-200 border border-transparent":e.startSmena}])},[n("span",Y,g(e.date.getDate()),1)],2))),256))]),n("tr",null,[t[2]||(t[2]=n("td",{class:"text-center"},[n("span",{class:"p-button-icon pi pi-sun text-orange-400"})],-1)),(i(!0),c(y,null,h(m.value,e=>{var l;return i(),c("td",{class:_(["text-center border-b border-b-surface-200 hover:bg-surface-100 cursor-pointer",{"border-l-surface-200 border border-transparent":e.startSmena}])},[n("div",$,g((l=x(a.transport.smena.formula.first[e.number]))==null?void 0:l.name),1)],2)}),256))]),n("tr",null,[t[3]||(t[3]=n("td",{class:"text-center"},[n("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"})],-1)),(i(!0),c(y,null,h(m.value,e=>{var l;return i(),c("td",{class:_(["text-center hover:bg-surface-100 cursor-pointer",{"border-l-surface-200 border border-transparent":e.startSmena}])},[n("div",G,g((l=x(a.transport.smena.formula.second[e.number]))==null?void 0:l.name),1)],2)}),256))])])])])])):(i(),c("div",H,[k(s,{severity:"warn"},{default:A(()=>t[4]||(t[4]=[E("Smena turi va Smena birinchi kunini tanlash shart")])),_:1,__:[4]})]))}}});export{tt as _};
