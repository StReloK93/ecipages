import{i as Y,B as Z,s as ee,j as te,k as se,c as s,l as B,e as t,m as G,h as C,n as j,p as H,t as k,d as F,q as w,v as O,x as ae,F as y,r as $,y as L,a,w as q,z as Q,b as T,A as V,C as oe,u as P,o as U,D as M,E as ne,_ as re,G as ie,H as le,T as ce}from"./app-2Osvv3AR.js";import{_ as J,a as de}from"./TabButton.vue_vue_type_script_setup_true_lang-P8gDU-AE.js";import{s as ue}from"./index-DiiFTuEz.js";import{s as W,_ as pe}from"./SmenaViewer.vue_vue_type_script_setup_true_lang-e0KN7yDW.js";import{s as me,a as he}from"./index-BmEfAbUo.js";import{s as fe}from"./index-CR8TXXMo.js";import{T as ve}from"./TransportListRepo-CUKp4jZa.js";import{C as ge}from"./ChangeRepo-Dhb__vO3.js";import{O as ye}from"./OrganizationRepo-CHw9wFzu.js";import"./index-BXqGvRMY.js";import"./PrimeInputs-Wi507987.js";import"./index.esm-C88Gxk8I.js";var be=Y`
    .p-chip {
        display: inline-flex;
        align-items: center;
        background: dt('chip.background');
        color: dt('chip.color');
        border-radius: dt('chip.border.radius');
        padding-block: dt('chip.padding.y');
        padding-inline: dt('chip.padding.x');
        gap: dt('chip.gap');
    }

    .p-chip-icon {
        color: dt('chip.icon.color');
        font-size: dt('chip.icon.font.size');
        width: dt('chip.icon.size');
        height: dt('chip.icon.size');
    }

    .p-chip-image {
        border-radius: 50%;
        width: dt('chip.image.width');
        height: dt('chip.image.height');
        margin-inline-start: calc(-1 * dt('chip.padding.y'));
    }

    .p-chip:has(.p-chip-remove-icon) {
        padding-inline-end: dt('chip.padding.y');
    }

    .p-chip:has(.p-chip-image) {
        padding-block-start: calc(dt('chip.padding.y') / 2);
        padding-block-end: calc(dt('chip.padding.y') / 2);
    }

    .p-chip-remove-icon {
        cursor: pointer;
        font-size: dt('chip.remove.icon.size');
        width: dt('chip.remove.icon.size');
        height: dt('chip.remove.icon.size');
        color: dt('chip.remove.icon.color');
        border-radius: 50%;
        transition:
            outline-color dt('chip.transition.duration'),
            box-shadow dt('chip.transition.duration');
        outline-color: transparent;
    }

    .p-chip-remove-icon:focus-visible {
        box-shadow: dt('chip.remove.icon.focus.ring.shadow');
        outline: dt('chip.remove.icon.focus.ring.width') dt('chip.remove.icon.focus.ring.style') dt('chip.remove.icon.focus.ring.color');
        outline-offset: dt('chip.remove.icon.focus.ring.offset');
    }
`,_e={root:"p-chip p-component",image:"p-chip-image",icon:"p-chip-icon",label:"p-chip-label",removeIcon:"p-chip-remove-icon"},xe=Z.extend({name:"chip",style:be,classes:_e}),ke={name:"BaseChip",extends:te,props:{label:{type:[String,Number],default:null},icon:{type:String,default:null},image:{type:String,default:null},removable:{type:Boolean,default:!1},removeIcon:{type:String,default:void 0}},style:xe,provide:function(){return{$pcChip:this,$parentInstance:this}}},X={name:"Chip",extends:ke,inheritAttrs:!1,emits:["remove"],data:function(){return{visible:!0}},methods:{onKeydown:function(l){(l.key==="Enter"||l.key==="Backspace")&&this.close(l)},close:function(l){this.visible=!1,this.$emit("remove",l)}},computed:{dataP:function(){return se({removable:this.removable})}},components:{TimesCircleIcon:ee}},we=["aria-label","data-p"],$e=["src"];function Ce(e,l,m,h,c,r){return c.visible?(t(),s("div",j({key:0,class:e.cx("root"),"aria-label":e.label},e.ptmi("root"),{"data-p":r.dataP}),[G(e.$slots,"default",{},function(){return[e.image?(t(),s("img",j({key:0,src:e.image},e.ptm("image"),{class:e.cx("image")}),null,16,$e)):e.$slots.icon?(t(),C(H(e.$slots.icon),j({key:1,class:e.cx("icon")},e.ptm("icon")),null,16,["class"])):e.icon?(t(),s("span",j({key:2,class:[e.cx("icon"),e.icon]},e.ptm("icon")),null,16)):B("",!0),e.label?(t(),s("div",j({key:3,class:e.cx("label")},e.ptm("label")),k(e.label),17)):B("",!0)]}),e.removable?G(e.$slots,"removeicon",{key:0,removeCallback:r.close,keydownCallback:r.onKeydown},function(){return[(t(),C(H(e.removeIcon?"span":"TimesCircleIcon"),j({class:[e.cx("removeIcon"),e.removeIcon],onClick:r.close,onKeydown:r.onKeydown},e.ptm("removeIcon")),null,16,["class","onClick","onKeydown"]))]}):B("",!0)],16,we)):B("",!0)}X.render=Ce;const Te={class:"flex gap-4 flex-col"},ze={key:1},De={class:"max-h-90 overflow-y-auto flex flex-col gap-2"},Se=["draggable","onDragstart"],Be={class:"font-medium text-gray-700 leading-4"},Le={class:"block"},Ie={class:"text-slate-500 text-sm"},Ae=F({__name:"DragBlockUser",props:{list:{},groupLavozims:{}},emits:["dragstart"],setup(e,{emit:l}){const m=w(""),h=l,c=e,r=O(),g=ae(()=>c.list.employes.filter(v=>v.name.toLowerCase().includes(m.value.toLowerCase())));return(v,z)=>{const b=W,d=he,o=fe,_=me;return t(),s("div",Te,[v.groupLavozims==null?(t(),s(y,{key:0},$(6,p=>L(b,{height:"42px",width:"100%","border-radius":"24px"})),64)):(t(),s("section",ze,[L(_,{class:"mb-4"},{default:q(()=>[L(d,{class:"pi pi-search"}),L(o,{modelValue:m.value,"onUpdate:modelValue":z[0]||(z[0]=p=>m.value=p),placeholder:"Qidiruv",fluid:"",class:"rounded-xl! border border-surface-100! shadow-none! bg-zinc-50!"},null,8,["modelValue"])]),_:1}),a("main",De,[(t(!0),s(y,null,$(g.value,p=>(t(),s("div",{key:p.id,draggable:!T(r).isAdmin,onDragstart:I=>h("dragstart",I,p),class:Q([[T(r).isAdmin?"cursor-default":"cursor-grab active:cursor-grabbing"],"select-none rounded-xl py-2 px-4 bg-zinc-50 border border-surface-100 hover:bg-blue-300/10 hover:border-blue-300 transition-all flex items-center gap-3"])},[a("div",Be,[a("span",Le,k(p.name),1),a("span",Ie," Razryad: "+k(p.razryad),1)]),z[1]||(z[1]=a("i",{class:"pi pi-clone ml-auto text-sky-600 text-sm mr-2"},null,-1))],42,Se))),128))])]))])}}}),R="groups",N={index(){return V.get(`${R}`)},byTransport(e){return V.get(`${R}/transport/${e}`)},show(e){return V.get(`${R}/${e}`)},async store(e){return await V.post(`${R}`,e)},update(e,l){return V.put(`${R}/${e}`,l)},destroy(e){return V.delete(`${R}/${e}`)}},je={class:"font-sans"},Ve={class:"mb-2 text-xl text-right text-blue-600"},Re={class:"text-base"},Ee={class:"flex gap-5"},qe={class:"w-1/4 rounded-xl h-fit"},Fe={class:"w-3/4 grid grid-cols-1 gap-4"},Ke={class:"flex justify-between items-center border-b border-gray-200 py-3 px-4"},Ne={class:"font-semibold text-gray-600 text-sm"},Oe={class:"flex flex-grow"},Pe=["onDragover","onDrop"],Ue={class:"absolute -top-1 right-2"},Me={key:1,class:"w-6 h-6 rounded-full bg-blue-100 text-blue-600 inline-flex items-center justify-center text-sm"},Ge={class:"flex flex-wrap gap-2 px-3 py-4 items-start animate-pop-in"},He=F({__name:"DragBlock",props:{list:{},lavozims:{},transport:{},changes:{}},setup(e){const l=O(),m=w(null),h=oe(),c=w(),r=e,{execute:g,data:v}=P(N.byTransport);function z(i){const n=r.changes.find(f=>f.id==i);return n?n.name:null}const b=new Set(Object.values(r.transport.smena.formula.first).sort((i,n)=>i-n)),d=w(null),o=w(null),_=(i,n)=>{d.value=n,i.dataTransfer&&(i.dataTransfer.effectAllowed="copy",i.dataTransfer.setData("text/plain",JSON.stringify(n)))},p=(i,n)=>{c.value!=n&&(c.value=n)},I=async(i,n,f)=>{var u,x;c.value=null;const A={transport_id:r.transport.id,change_id:f,employe_id:(u=d.value)==null?void 0:u.id,lavozim_id:n.id};if(d.value){if(n[f].some(S=>{var K;return S.employe.id===((K=d.value)==null?void 0:K.id)}))return h.add({severity:"warn",summary:"Takrorlamang!",detail:`${(x=d.value)==null?void 0:x.name} bu smenada  mavjud.`,life:5e3});m.value=n[f],await N.store(A).then(S=>{n[f].push(S.data)}).catch(()=>{var S;h.add({severity:"error",summary:`${(S=d.value)==null?void 0:S.name} bu smenada  mavjud.`,detail:"Bir kishi bir smenada ikki lavozimda ishlay olmaydi!",life:5e3})}).finally(()=>{m.value=null}),d.value=null}},E=(i,n,f)=>{N.destroy(i).then(A=>{n.splice(f,1)})};return U(async()=>{await g(r.transport.id),o.value=r.lavozims.map(i=>(b.forEach(n=>{var A;const f=(A=v.value)==null?void 0:A.filter(u=>u.change_id==n&&u.lavozim_id==i.id&&u.transport_id==r.transport.id);i[n]=[],f==null||f.forEach(u=>{i[n].push(u)})}),i))}),(i,n)=>{const f=W,A=X;return t(),s("div",je,[a("h3",Ve,[M(k(i.transport.garage_number)+" - ",1),a("span",Re,k(i.list.name),1)]),a("div",Ee,[a("div",qe,[L(Ae,{groupLavozims:o.value,list:r.list,onDragstart:_},null,8,["groupLavozims","list"])]),a("div",Fe,[o.value==null?(t(),s(y,{key:0},$(2,u=>L(f,{"border-radius":"12px",height:"208px",width:"100%"})),64)):(t(!0),s(y,{key:1},$(o.value,u=>(t(),s("div",{key:u.id,class:"min-h-52 border border-gray-200 rounded-xl flex flex-col bg-white"},[a("div",Ke,[a("span",Ne,k(u.name),1)]),a("main",Oe,[(t(!0),s(y,null,$(T(b),x=>(t(),s("div",{onDragover:ne(D=>p(D,u[x]),["prevent"]),onDragleave:n[0]||(n[0]=D=>c.value=null),onDrop:D=>I(D,u,x),class:Q([{"bg-surface-50":c.value==u[x]},"basis-0 flex-grow border-l first:border-0 border-surface-100 h-full relative transition-all"])},[a("span",Ue,[m.value==u[x]?(t(),C(f,{key:0,shape:"circle",height:"24px",width:"24px"})):(t(),s("span",Me,k(z(x)),1))]),a("div",Ge,[(t(!0),s(y,null,$(u[x],(D,S)=>(t(),C(A,{onRemove:K=>E(D.id,u[x],S),key:D,label:D.employe.name,class:"text-xs! animate-pop-in",removable:!T(l).isAdmin},null,8,["onRemove","label","removable"]))),128))])],42,Pe))),256))])]))),128))])])])}}}),Qe=re(He,[["__scopeId","data-v-d8a5942a"]]),Je={class:"flex w-full"},We={class:"min-w-48 relative z-50 the-shadow"},Xe={class:"absolute inset-0 overflow-y-auto overflow-x-hidden h-full flex flex-col gap-1 py-10 scroll-left"},Ye={class:"font-semibold text-[16px]"},Ze={class:"p-8 pt-4 flex-grow bg-white border border-gray-100 rounded-4xl min-h-154 shadow-xs"},et={key:0,class:"flex items-center justify-center h-full"},tt={key:1,class:"flex items-center justify-center h-full"},st={key:2},at=F({__name:"ActiveTransportTab",props:{transport_type:{}},setup(e){const l=e,m=w([]),h=w(null),c=w(null),r=w(0),{execute:g,data:v,isFirstLoading:z}=P(ge.index);async function b(d,o){c.value=null,h.value=null,await ie(),h.value=d,c.value=o}return U(async()=>{const{data:d}=await ve.byTransportType(l.transport_type.id);await g(),m.value=d;let o=null,_=null;for(const p of d)if(p.transports.length>0){o=p.transports[0],_=p;break}_&&o&&b(o,_)}),(d,o)=>{const _=ue;return t(),s("section",Je,[a("nav",We,[a("main",Xe,[(t(!0),s(y,null,$(m.value,p=>(t(),s(y,null,[(t(!0),s(y,null,$(p.transports,I=>{var E;return t(),C(J,{class:"w-full text-left",direction:"right",onClick:i=>b(I,p),active:((E=h.value)==null?void 0:E.id)==I.id,onVnodeMounted:o[0]||(o[0]=i=>r.value++)},{default:q(()=>[M(k(p.name)+" - ",1),a("span",Ye,k(I.garage_number),1)]),_:2},1032,["onClick","active"])}),256))],64))),256))])]),a("aside",Ze,[T(z)?(t(),s("main",et,[L(_)])):r.value==0?(t(),s("main",tt,o[1]||(o[1]=[a("div",{class:"w-120 text-center"},[a("h3",{class:"text-gray-800 text-2xl mb-1 font-semibold"},"Qurilmalar kiritilmagan"),a("p",{class:"text-gray-500"}," Hozirda ushbu transport turiga hech qanday qurilma kiritilmagan. Iltimos, avval transport turlariga mos qurilmalarni qo'shing. ")],-1)]))):(t(),s("main",st,[c.value&&h.value&&T(v)?(t(),C(Qe,{key:0,class:"mb-4",changes:T(v),list:c.value,lavozims:l.transport_type.lavozims,transport:h.value},null,8,["changes","list","lavozims","transport"])):B("",!0),a("main",null,[h.value?(t(),C(pe,{key:0,transport:h.value},null,8,["transport"])):B("",!0)])]))])])}}}),ot={key:0,name:"tabs",class:"flex flex-col p-5"},nt={class:"flex gap-0.5 pl-60 relative z-10 justify-between items-end"},rt={class:"relative"},bt=F({__name:"OrganizationPage",props:["id"],setup(e){const l=e,m=w(null),h=O(),{execute:c,isLoading:r,data:g}=P(ye.transports);return le(()=>l.id,v=>c({id:v})),U(async()=>{var v;h.isAdmin?await c({id:l.id}):await c({id:(v=h.user)==null?void 0:v.organization_id}),g.value&&g.value.transport_types[0]&&(m.value=g.value.transport_types[0].id)}),(v,z)=>{var b,d;return T(r)?B("",!0):(t(),s("section",ot,[a("nav",nt,[a("main",null,[(t(!0),s(y,null,$((b=T(g))==null?void 0:b.transport_types,o=>(t(),C(J,{class:"text-xl!",active:m.value==o.id,onClick:_=>m.value=o.id},{default:q(()=>[M(k(o.name),1)]),_:2},1032,["active","onClick"]))),256))]),L(de,{id:l.id},null,8,["id"])]),a("main",rt,[(t(!0),s(y,null,$((d=T(g))==null?void 0:d.transport_types,o=>(t(),C(ce,{name:"fade",mode:"out-in"},{default:q(()=>[o.id===m.value?(t(),C(at,{key:o.id,transport_type:o},null,8,["transport_type"])):B("",!0)]),_:2},1024))),256))])]))}}});export{bt as default};
