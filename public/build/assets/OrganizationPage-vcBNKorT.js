import{i as W,B as X,s as Y,j as Z,k as ee,c as a,l as D,e as t,m as O,h as w,n as S,p as U,t as z,d as E,q as C,v as te,F as _,r as k,x as R,a as p,w as A,y as L,z as re,u as F,o as P,b as V,A as q,C as ae,_ as oe,D as G,E as se,G as ne,H as ie,T as le}from"./app-Ca4-ZskA.js";import{s as M,_ as ce}from"./SmenaViewer.vue_vue_type_script_setup_true_lang-BAVivR43.js";import{s as de,a as pe}from"./index-CestPQB5.js";import{s as ue}from"./index-BYdX81k2.js";import{T as me}from"./TransportListRepo-BZn2cg2P.js";import{C as he}from"./ChangeRepo-DQfTKjEf.js";import{O as fe}from"./OrganizationRepo-fA67PYe7.js";import"./index-C0PRBhdl.js";import"./PrimeInputs-B009bsaV.js";import"./index.esm-C88Gxk8I.js";var ve=W`
    .p-chip {
        display: inline-flex;
        align-items: center;
        background: dt('chip.background');
        color: dt('chip.color');
        border-radius: dt('chip.border.radius');
        padding-block: dt('chip.padding.y');
        padding-inline: dt('chip.padding.x');
        gap: dt('chip.gap');
    }

    .p-chip-icon {
        color: dt('chip.icon.color');
        font-size: dt('chip.icon.font.size');
        width: dt('chip.icon.size');
        height: dt('chip.icon.size');
    }

    .p-chip-image {
        border-radius: 50%;
        width: dt('chip.image.width');
        height: dt('chip.image.height');
        margin-inline-start: calc(-1 * dt('chip.padding.y'));
    }

    .p-chip:has(.p-chip-remove-icon) {
        padding-inline-end: dt('chip.padding.y');
    }

    .p-chip:has(.p-chip-image) {
        padding-block-start: calc(dt('chip.padding.y') / 2);
        padding-block-end: calc(dt('chip.padding.y') / 2);
    }

    .p-chip-remove-icon {
        cursor: pointer;
        font-size: dt('chip.remove.icon.size');
        width: dt('chip.remove.icon.size');
        height: dt('chip.remove.icon.size');
        color: dt('chip.remove.icon.color');
        border-radius: 50%;
        transition:
            outline-color dt('chip.transition.duration'),
            box-shadow dt('chip.transition.duration');
        outline-color: transparent;
    }

    .p-chip-remove-icon:focus-visible {
        box-shadow: dt('chip.remove.icon.focus.ring.shadow');
        outline: dt('chip.remove.icon.focus.ring.width') dt('chip.remove.icon.focus.ring.style') dt('chip.remove.icon.focus.ring.color');
        outline-offset: dt('chip.remove.icon.focus.ring.offset');
    }
`,ge={root:"p-chip p-component",image:"p-chip-image",icon:"p-chip-icon",label:"p-chip-label",removeIcon:"p-chip-remove-icon"},be=X.extend({name:"chip",style:ve,classes:ge}),ye={name:"BaseChip",extends:Z,props:{label:{type:[String,Number],default:null},icon:{type:String,default:null},image:{type:String,default:null},removable:{type:Boolean,default:!1},removeIcon:{type:String,default:void 0}},style:be,provide:function(){return{$pcChip:this,$parentInstance:this}}},H={name:"Chip",extends:ye,inheritAttrs:!1,emits:["remove"],data:function(){return{visible:!0}},methods:{onKeydown:function(r){(r.key==="Enter"||r.key==="Backspace")&&this.close(r)},close:function(r){this.visible=!1,this.$emit("remove",r)}},computed:{dataP:function(){return ee({removable:this.removable})}},components:{TimesCircleIcon:Y}},_e=["aria-label","data-p"],xe=["src"];function ke(e,r,i,s,n,g){return n.visible?(t(),a("div",S({key:0,class:e.cx("root"),"aria-label":e.label},e.ptmi("root"),{"data-p":g.dataP}),[O(e.$slots,"default",{},function(){return[e.image?(t(),a("img",S({key:0,src:e.image},e.ptm("image"),{class:e.cx("image")}),null,16,xe)):e.$slots.icon?(t(),w(U(e.$slots.icon),S({key:1,class:e.cx("icon")},e.ptm("icon")),null,16,["class"])):e.icon?(t(),a("span",S({key:2,class:[e.cx("icon"),e.icon]},e.ptm("icon")),null,16)):D("",!0),e.label?(t(),a("div",S({key:3,class:e.cx("label")},e.ptm("label")),z(e.label),17)):D("",!0)]}),e.removable?O(e.$slots,"removeicon",{key:0,removeCallback:g.close,keydownCallback:g.onKeydown},function(){return[(t(),w(U(e.removeIcon?"span":"TimesCircleIcon"),S({class:[e.cx("removeIcon"),e.removeIcon],onClick:g.close,onKeydown:g.onKeydown},e.ptm("removeIcon")),null,16,["class","onClick","onKeydown"]))]}):D("",!0)],16,_e)):D("",!0)}H.render=ke;const we={class:"flex gap-4 flex-col"},$e={key:1},Ce={class:"max-h-90 overflow-y-auto flex flex-col gap-2"},Te=["onDragstart"],De={class:"font-medium text-gray-700 leading-4"},ze={class:"block"},Be={class:"text-slate-500 text-sm"},Se=E({__name:"DragBlockUser",props:{list:{},groupLavozims:{}},emits:["dragstart"],setup(e,{emit:r}){const i=C(""),s=r,n=e,g=te(()=>n.list.employes.filter(v=>v.name.toLowerCase().includes(i.value.toLowerCase())));return(v,m)=>{const y=M,l=pe,u=ue,c=de;return t(),a("div",we,[v.groupLavozims==null?(t(),a(_,{key:0},k(6,b=>R(y,{height:"42px",width:"100%","border-radius":"24px"})),64)):(t(),a("section",$e,[R(c,{class:"mb-4"},{default:A(()=>[R(l,{class:"pi pi-search"}),R(u,{modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=b=>i.value=b),placeholder:"Qidiruv",fluid:"",class:"rounded-xl! border border-surface-100! shadow-none!"},null,8,["modelValue"])]),_:1}),p("main",Ce,[(t(!0),a(_,null,k(g.value,b=>(t(),a("div",{key:b.id,draggable:"true",onDragstart:j=>s("dragstart",j,b),class:"rounded-xl py-2 px-4 bg-white border border-surface-100 cursor-grab active:cursor-grabbing hover:bg-blue-50 hover:border-blue-300 transition-all flex items-center gap-3"},[p("div",De,[p("span",ze,z(b.name),1),p("span",Be," Razryad: "+z(b.razryad),1)]),m[1]||(m[1]=p("i",{class:"pi pi-clone ml-auto text-sky-600 text-sm mr-2"},null,-1))],40,Te))),128))])]))])}}}),I="groups",N={index(){return L.get(`${I}`)},byTransport(e){return L.get(`${I}/transport/${e}`)},show(e){return L.get(`${I}/${e}`)},async store(e){return await L.post(`${I}`,e)},update(e,r){return L.put(`${I}/${e}`,r)},destroy(e){return L.delete(`${I}/${e}`)}},Le={class:"font-sans"},Ie={class:"flex gap-5"},Re={class:"w-1/4 rounded-xl h-fit"},Ve={class:"w-3/4 grid grid-cols-1 gap-4"},Ee={class:"flex justify-between items-center border-b border-gray-100 py-3 px-4"},je={class:"font-semibold text-gray-600 text-sm"},Ae={class:"flex flex-grow"},Ke=["onDragover","onDrop"],Ne={class:"absolute top-2 right-2"},Oe={key:1,class:"w-6 h-6 rounded-full bg-blue-100 text-blue-600 inline-flex items-center justify-center text-sm"},Fe={class:"flex flex-wrap gap-2 p-3 items-start animate-pop-in"},Pe=E({__name:"DragBlock",props:{list:{},lavozims:{},transport:{},changes:{}},setup(e){const r=C(null),i=re(),s=C(),n=e,{execute:g,data:v}=F(N.byTransport);function m(h){const o=n.changes.find(f=>f.id==h);return o?o.name:null}const y=new Set(Object.values(n.transport.smena.formula.first)),l=C(null),u=C(null),c=(h,o)=>{l.value=o,h.dataTransfer&&(h.dataTransfer.effectAllowed="copy",h.dataTransfer.setData("text/plain",JSON.stringify(o)))},b=(h,o)=>{s.value!=o&&(s.value=o)},j=async(h,o,f)=>{var d,x;s.value=null;const B={transport_id:n.transport.id,change_id:f,employe_id:(d=l.value)==null?void 0:d.id,lavozim_id:o.id};if(l.value){if(o[f].some(T=>{var K;return T.employe.id===((K=l.value)==null?void 0:K.id)}))return i.add({severity:"warn",summary:"Takrorlamang!",detail:`${(x=l.value)==null?void 0:x.name} bu smenada  mavjud.`,life:5e3});r.value=o[f],await N.store(B).then(T=>{o[f].push(T.data)}).catch(()=>{var T;i.add({severity:"error",summary:`${(T=l.value)==null?void 0:T.name} bu smenada  mavjud.`,detail:"Bir kishi bir smenada ikki lavozimda ishlay olmaydi!",life:5e3})}).finally(()=>{r.value=null}),l.value=null}},Q=(h,o,f)=>{N.destroy(h).then(B=>{o.splice(f,1)})};return P(async()=>{await g(n.transport.id),u.value=n.lavozims.map(h=>(y.forEach(o=>{var B;const f=(B=v.value)==null?void 0:B.filter(d=>d.change_id==o&&d.lavozim_id==h.id&&d.transport_id==n.transport.id);h[o]=[],f==null||f.forEach(d=>{h[o].push(d)})}),h))}),(h,o)=>{const f=M,B=H;return t(),a("div",Le,[p("div",Ie,[p("div",Re,[R(Se,{groupLavozims:u.value,list:n.list,onDragstart:c},null,8,["groupLavozims","list"])]),p("div",Ve,[u.value==null?(t(),a(_,{key:0},k(2,d=>R(f,{"border-radius":"12px",height:"208px",width:"100%"})),64)):(t(!0),a(_,{key:1},k(u.value,d=>(t(),a("div",{key:d.id,class:"min-h-52 border border-surface-100 rounded-xl flex flex-col bg-white"},[p("div",Ee,[p("span",je,z(d.name),1)]),p("main",Ae,[(t(!0),a(_,null,k(V(y),x=>(t(),a("div",{onDragover:ae($=>b($,d[x]),["prevent"]),onDragleave:o[0]||(o[0]=$=>s.value=null),onDrop:$=>j($,d,x),class:q([{"bg-surface-50":s.value==d[x]},"basis-0 flex-grow border-l first:border-0 border-surface-100 h-full relative transition-all"])},[p("span",Ne,[r.value==d[x]?(t(),w(f,{key:0,shape:"circle",height:"24px",width:"24px"})):(t(),a("span",Oe,z(m(x)),1))]),p("div",Fe,[(t(!0),a(_,null,k(d[x],($,T)=>(t(),w(B,{onRemove:K=>Q($.id,d[x],T),key:$,label:$.employe.name,class:"text-xs! animate-pop-in",removable:""},null,8,["onRemove","label"]))),128))])],42,Ke))),256))])]))),128))])])])}}}),Ue=oe(Pe,[["__scopeId","data-v-2b92bdef"]]),J=E({__name:"TabButton",props:{active:{type:Boolean},direction:{default:"bottom"}},setup(e){const r=e,i={left:{border:"border-l hover:border-l-gray-500 dark:hover:border-l-gray-300",active:"!border-l-gray-500 dark:!border-l-gray-300",different:"right-px"},right:{border:"border-r hover:border-r-gray-500 dark:hover:border-r-gray-300",active:"!border-r-gray-500 dark:!border-r-gray-300",different:"left-px"},top:{border:"border-t hover:border-t-gray-500 dark:hover:border-t-gray-300",active:"!border-t-gray-500 dark:!border-t-gray-300",different:"bottom-px"},bottom:{border:"border-b hover:border-b-gray-500 dark:hover:border-b-gray-300",active:"!border-b-gray-600 dark:!border-b-gray-300",different:"top-px"}};return(s,n)=>(t(),a("button",{class:q(["py-1 text-sm px-3 border-transparent cursor-pointer relative",[{"font-semibold":r.active},{[i[r.direction].active]:r.active},i[r.direction].border,i[r.direction].different]])},[O(s.$slots,"default")],2))}}),qe={class:"flex flex-grow w-full"},Ge={class:"flex flex-col gap-0.5 items-end py-8 min-w-44"},Me={class:"p-8 flex-grow bg-zinc-50 dark:bg-zinc-900 border border-gray-200/80 dark:border-zinc-600 rounded-4xl min-h-154"},He=E({__name:"ActiveTransportTab",props:{transport_type:{}},setup(e){const r=e,i=C([]),s=C(null),n=C(null),{execute:g,data:v}=F(he.index);async function m(y,l){n.value=null,s.value=null,await se(),s.value=y,n.value=l}return P(async()=>{const{data:y}=await me.byTransportType(r.transport_type.id);await g(),i.value=y;let l=null,u=null;for(const c of y)if(c.transports.length>0){l=c.transports[0],u=c;break}u&&l&&m(l,u)}),(y,l)=>(t(),a("main",qe,[p("nav",Ge,[(t(!0),a(_,null,k(i.value,u=>(t(),a(_,null,[(t(!0),a(_,null,k(u.transports,c=>{var b;return t(),w(J,{class:"w-full text-left",direction:"right",onClick:j=>m(c,u),active:((b=s.value)==null?void 0:b.id)==c.id},{default:A(()=>[G(z(c.garage_number)+" - "+z(u.name),1)]),_:2},1032,["onClick","active"])}),256))],64))),256))]),p("aside",Me,[n.value&&s.value&&V(v)?(t(),w(Ue,{key:0,class:"mb-4",changes:V(v),list:n.value,lavozims:r.transport_type.lavozims,transport:s.value},null,8,["changes","list","lavozims","transport"])):D("",!0),p("main",null,[s.value?(t(),w(ce,{key:0,transport:s.value},null,8,["transport"])):D("",!0)])])]))}}),Je={key:0,name:"tabs",class:"flex flex-col p-5"},Qe={class:"flex gap-0.5 dark:border-zinc-600 pl-48"},We={class:"relative"},it=E({__name:"OrganizationPage",props:["id"],setup(e){const r=e,i=C(null),s=ne(),{execute:n,isLoading:g,data:v}=F(fe.transports);return ie(()=>r.id,m=>n({id:m})),P(async()=>{var m;s.isAdmin?await n({id:r.id}):await n({id:(m=s.user)==null?void 0:m.organization_id}),v.value&&v.value.transport_types[0]&&(i.value=v.value.transport_types[0].id)}),(m,y)=>{var l,u;return V(g)?D("",!0):(t(),a("section",Je,[p("nav",Qe,[(t(!0),a(_,null,k((l=V(v))==null?void 0:l.transport_types,c=>(t(),w(J,{class:"text-xl!",active:i.value==c.id,onClick:b=>i.value=c.id},{default:A(()=>[G(z(c.name),1)]),_:2},1032,["active","onClick"]))),256))]),p("main",We,[(t(!0),a(_,null,k((u=V(v))==null?void 0:u.transport_types,c=>(t(),w(le,{name:"fade",mode:"out-in"},{default:A(()=>[c.id===i.value?(t(),w(He,{key:c.id,transport_type:c},null,8,["transport_type"])):D("",!0)]),_:2},1024))),256))])]))}}});export{it as default};
