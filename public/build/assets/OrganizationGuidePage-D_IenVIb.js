import{s as k,a as O,_ as U,b as q,c as D}from"./BaseForm.vue_vue_type_script_setup_true_lang-C2v4_LeH.js";import{s as T}from"./index-CBr-MpG8.js";import{d as R,v as E,g as h,w as l,a as x,b as i,p as w,h as V,t as $,o as _,k as z,x as I,c as S,y as j,u as C}from"./app-Dqq4a65M.js";import{O as g}from"./OrganizationRepo-SAoGxYYw.js";import"./useFetch-D45EbHv3.js";const F={class:"mb-4"},M=R({__name:"FormCreateOrganization",props:{submit:{type:Function}},setup(N){const m=E({name:"",name_ru:""}),v=({values:r})=>{const t={},u={message:"To'ldiring"};return r.name||(t.name=[u]),r.name_ru||(t.name_ru=[u]),{values:r,errors:t}};return(r,t)=>{const u=k,f=O;return _(),h(U,{submit:r.submit,resolver:v,initialValues:m,onClose:t[0]||(t[0]=d=>r.$emit("close"))},{default:l(d=>{var n,e;return[x("div",F,[i(u,{name:"name",severity:"contrast",type:"text",placeholder:"Nomi",size:"small",fluid:""}),(n=d.form.name)!=null&&n.invalid?(_(),h(f,{key:0,severity:"error",size:"small",variant:"simple"},{default:l(()=>[V($(d.form.name.error.message),1)]),_:2},1024)):w("",!0)]),x("div",null,[i(u,{name:"name_ru",type:"text",placeholder:"Nomi(ru)",size:"small",fluid:""}),(e=d.form.name_ru)!=null&&e.invalid?(_(),h(f,{key:0,severity:"error",size:"small",variant:"simple"},{default:l(()=>[V($(d.form.name_ru.error.message),1)]),_:2},1024)):w("",!0)])]}),_:1},8,["submit","initialValues"])}}}),A={class:"mb-3 text-end"},J=R({__name:"OrganizationGuidePage",setup(N){const m=z(!1),v=z([]),r=I(),{data:t}=g.index();async function u(n){await new Promise((e,o)=>{g.store(n,({data:s})=>{var c;e(!0),(c=t.value)==null||c.push(s),m.value=!1})})}const f=n=>{r.require({message:`(${n.name}) - Aniq o'chirmoqchimisiz?`,header:"O'chirish",rejectProps:{label:"Bekor qilish",severity:"secondary",outlined:!0},acceptProps:{label:"O'chirish",severity:"danger"},accept:()=>{g.destroy(n.id,()=>{var o,s;const e=(o=t.value)==null?void 0:o.findIndex(c=>c.id==n.id);e>-1&&((s=t.value)==null||s.splice(e,1))})}})};function d(n){var s;let{newData:e,index:o}=n;g.update(e.id,e),(s=t.value)!=null&&s.length&&(t.value[o].name=e.name,t.value[o].name_ru=e.name_ru)}return(n,e)=>{const o=j,s=T,c=k,y=q,B=D;return _(),S("div",null,[x("main",A,[i(o,{icon:"pi pi-plus",label:"Qo'shish",size:"small",severity:"contrast",onClick:e[0]||(e[0]=a=>m.value=!0)}),i(s,{header:"Bo'linma qo'shish","show-close-icon":!1,visible:m.value,"onUpdate:visible":e[2]||(e[2]=a=>m.value=a),position:"right"},{default:l(()=>[i(M,{onClose:e[1]||(e[1]=a=>m.value=!1),submit:u})]),_:1},8,["visible"])]),C(t)?(_(),h(B,{key:0,size:"small",editingRows:v.value,"onUpdate:editingRows":e[3]||(e[3]=a=>v.value=a),value:C(t),editMode:"row",dataKey:"id",onRowEditSave:d},{default:l(()=>[i(y,{field:"name",header:"Nomi"},{editor:l(({data:a,field:p})=>[i(c,{modelValue:a[p],"onUpdate:modelValue":b=>a[p]=b,type:"text",size:"small",fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),i(y,{field:"name_ru",header:"Nomi (ru)"},{editor:l(({data:a,field:p})=>[i(c,{modelValue:a[p],"onUpdate:modelValue":b=>a[p]=b,type:"text",size:"small",fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),i(y,{rowEditor:!0,style:{width:"120px"},bodyStyle:"text-align:right"}),i(y,{style:{width:"50px"}},{body:l(({data:a})=>[i(o,{icon:"pi pi-trash",type:"button",onClick:p=>f(a),severity:"secondary",variant:"text",rounded:""},null,8,["onClick"])]),_:1})]),_:1},8,["editingRows","value"])):w("",!0)])}}});export{J as default};
