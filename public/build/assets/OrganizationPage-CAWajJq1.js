import{i as se,B as ae,s as ne,j as oe,k as re,c as o,l as A,e as s,m as Y,h as z,n as K,p as W,t as f,d as q,q as C,v as U,x as ie,F as k,r as T,y as I,a,w as N,z as X,b as x,A as V,C as le,u as P,o as G,D as E,E as ce,_ as de,G as ue,H as pe,I as me,J as he,T as fe}from"./app-dH86ap2f.js";import{_ as Z,a as ge}from"./TabButton.vue_vue_type_script_setup_true_lang-DjjkdsMr.js";import{s as ve}from"./index-CWg-6Eev.js";import{s as ee,_ as ye}from"./SmenaViewer.vue_vue_type_script_setup_true_lang-XNub0IdV.js";import{s as be,a as _e}from"./index-VSdHjJ8o.js";import{s as xe}from"./index-BmilbAHz.js";import{T as ke}from"./TransportListRepo-fVJ4lL3p.js";import{C as $e}from"./ChangeRepo-CgZZen10.js";import{O as we}from"./OrganizationRepo-DtEQvhtG.js";import"./index-3ogy8MAf.js";import"./PrimeInputs-CSl5atqX.js";import"./index.esm-C88Gxk8I.js";var Ce=se`
    .p-chip {
        display: inline-flex;
        align-items: center;
        background: dt('chip.background');
        color: dt('chip.color');
        border-radius: dt('chip.border.radius');
        padding-block: dt('chip.padding.y');
        padding-inline: dt('chip.padding.x');
        gap: dt('chip.gap');
    }

    .p-chip-icon {
        color: dt('chip.icon.color');
        font-size: dt('chip.icon.font.size');
        width: dt('chip.icon.size');
        height: dt('chip.icon.size');
    }

    .p-chip-image {
        border-radius: 50%;
        width: dt('chip.image.width');
        height: dt('chip.image.height');
        margin-inline-start: calc(-1 * dt('chip.padding.y'));
    }

    .p-chip:has(.p-chip-remove-icon) {
        padding-inline-end: dt('chip.padding.y');
    }

    .p-chip:has(.p-chip-image) {
        padding-block-start: calc(dt('chip.padding.y') / 2);
        padding-block-end: calc(dt('chip.padding.y') / 2);
    }

    .p-chip-remove-icon {
        cursor: pointer;
        font-size: dt('chip.remove.icon.size');
        width: dt('chip.remove.icon.size');
        height: dt('chip.remove.icon.size');
        color: dt('chip.remove.icon.color');
        border-radius: 50%;
        transition:
            outline-color dt('chip.transition.duration'),
            box-shadow dt('chip.transition.duration');
        outline-color: transparent;
    }

    .p-chip-remove-icon:focus-visible {
        box-shadow: dt('chip.remove.icon.focus.ring.shadow');
        outline: dt('chip.remove.icon.focus.ring.width') dt('chip.remove.icon.focus.ring.style') dt('chip.remove.icon.focus.ring.color');
        outline-offset: dt('chip.remove.icon.focus.ring.offset');
    }
`,Te={root:"p-chip p-component",image:"p-chip-image",icon:"p-chip-icon",label:"p-chip-label",removeIcon:"p-chip-remove-icon"},Se=ae.extend({name:"chip",style:Ce,classes:Te}),De={name:"BaseChip",extends:oe,props:{label:{type:[String,Number],default:null},icon:{type:String,default:null},image:{type:String,default:null},removable:{type:Boolean,default:!1},removeIcon:{type:String,default:void 0}},style:Se,provide:function(){return{$pcChip:this,$parentInstance:this}}},te={name:"Chip",extends:De,inheritAttrs:!1,emits:["remove"],data:function(){return{visible:!0}},methods:{onKeydown:function(r){(r.key==="Enter"||r.key==="Backspace")&&this.close(r)},close:function(r){this.visible=!1,this.$emit("remove",r)}},computed:{dataP:function(){return re({removable:this.removable})}},components:{TimesCircleIcon:ne}},ze=["aria-label","data-p"],Be=["src"];function Ie(e,r,p,m,d,c){return d.visible?(s(),o("div",K({key:0,class:e.cx("root"),"aria-label":e.label},e.ptmi("root"),{"data-p":c.dataP}),[Y(e.$slots,"default",{},function(){return[e.image?(s(),o("img",K({key:0,src:e.image},e.ptm("image"),{class:e.cx("image")}),null,16,Be)):e.$slots.icon?(s(),z(W(e.$slots.icon),K({key:1,class:e.cx("icon")},e.ptm("icon")),null,16,["class"])):e.icon?(s(),o("span",K({key:2,class:[e.cx("icon"),e.icon]},e.ptm("icon")),null,16)):A("",!0),e.label?(s(),o("div",K({key:3,class:e.cx("label")},e.ptm("label")),f(e.label),17)):A("",!0)]}),e.removable?Y(e.$slots,"removeicon",{key:0,removeCallback:c.close,keydownCallback:c.onKeydown},function(){return[(s(),z(W(e.removeIcon?"span":"TimesCircleIcon"),K({class:[e.cx("removeIcon"),e.removeIcon],onClick:c.close,onKeydown:c.onKeydown},e.ptm("removeIcon")),null,16,["class","onClick","onKeydown"]))]}):A("",!0)],16,ze)):A("",!0)}te.render=Ie;function M(e){const r=["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"],p=["Yakshanba","Dushanba","Seshanba","Chorshanba","Payshanba","Juma","Shanba"];return{month:r[e.getMonth()],day:e.getDate(),weekday:p[e.getDay()]}}const Le={class:"flex gap-4 flex-col"},Ae={key:1},je={class:"max-h-90 overflow-y-auto flex flex-col gap-2"},Ve=["draggable","onDragstart"],Re={class:"font-medium text-gray-700 leading-4"},Ee={class:"block"},Fe={class:"text-slate-500 text-sm"},Ke=q({__name:"DragBlockUser",props:{list:{},groupLavozims:{}},emits:["dragstart"],setup(e,{emit:r}){const p=C(""),m=r,d=e,c=U(),$=ie(()=>d.list.employes.filter(g=>g.name.toLowerCase().includes(p.value.toLowerCase())));return(g,h)=>{const B=ee,b=_e,v=xe,j=be;return s(),o("div",Le,[g.groupLavozims==null?(s(),o(k,{key:0},T(6,w=>I(B,{height:"42px",width:"100%","border-radius":"24px"})),64)):(s(),o("section",Ae,[I(j,{class:"mb-4"},{default:N(()=>[I(b,{class:"pi pi-search"}),I(v,{modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=w=>p.value=w),placeholder:"Qidiruv",fluid:"",class:"rounded-xl! border border-surface-100! shadow-none! bg-zinc-50!"},null,8,["modelValue"])]),_:1}),a("main",je,[(s(!0),o(k,null,T($.value,w=>(s(),o("div",{key:w.id,draggable:!x(c).isAdmin,onDragstart:F=>m("dragstart",F,w),class:X([[x(c).isAdmin?"cursor-default":"cursor-grab active:cursor-grabbing"],"select-none rounded-xl py-2 px-4 bg-zinc-50 border border-surface-100 hover:bg-blue-300/10 hover:border-blue-300 transition-all flex items-center gap-3"])},[a("div",Re,[a("span",Ee,f(w.name),1),a("span",Fe," Razryad: "+f(w.razryad),1)]),h[1]||(h[1]=a("i",{class:"pi pi-clone ml-auto text-sky-600 text-sm mr-2"},null,-1))],42,Ve))),128))])]))])}}}),R="groups",O={index(){return V.get(`${R}`)},byTransport(e){return V.get(`${R}/transport/${e}`)},byTransportChange(e,r){return V.post(`${R}/transport/change`,{transport_id:e,change_id:r})},show(e){return V.get(`${R}/${e}`)},async store(e){return await V.post(`${R}`,e)},update(e,r){return V.put(`${R}/${e}`,r)},destroy(e){return V.delete(`${R}/${e}`)}},Ne={class:"font-sans"},Oe={class:"mb-2 text-xl text-right text-blue-600"},Pe={class:"text-base"},qe={class:"flex gap-5"},Me={class:"w-1/4 rounded-xl h-fit"},Ue={class:"w-3/4 grid grid-cols-1 gap-4 content-start"},Ge={class:"flex justify-between items-center border-b border-gray-200 py-3 px-4"},Je={class:"font-semibold text-gray-600 text-sm"},He={class:"flex flex-grow"},Qe=["onDragover","onDrop"],Ye={class:"absolute -top-1 right-2"},We={key:1,class:"w-6 h-6 rounded-full bg-blue-100 text-blue-600 inline-flex items-center justify-center text-sm"},Xe={class:"flex flex-wrap gap-2 px-3 py-4 items-start animate-pop-in"},Ze=q({__name:"DragBlock",props:{list:{},lavozims:{},transport:{},changes:{}},setup(e){const r=U(),p=C(null),m=le(),d=C(),c=e,{execute:$,data:g}=P(O.byTransport);function h(t){const n=c.changes.find(i=>i.id==t);return n?n.name:null}const B=new Set(Object.values(c.transport.smena.formula.first).sort((t,n)=>t-n)),b=C(null),v=C(null),j=(t,n)=>{b.value=n,t.dataTransfer&&(t.dataTransfer.effectAllowed="copy",t.dataTransfer.setData("text/plain",JSON.stringify(n)))},w=(t,n)=>{d.value!=n&&(d.value=n)},F=async(t,n,i)=>{var l,u;d.value=null;const D={transport_id:c.transport.id,change_id:i,employe_id:(l=b.value)==null?void 0:l.id,lavozim_id:n.id};if(b.value){if(n[i].some(_=>{var L;return _.employe.id===((L=b.value)==null?void 0:L.id)}))return m.add({severity:"warn",summary:"Takrorlamang!",detail:`${(u=b.value)==null?void 0:u.name} bu smenada  mavjud.`,life:5e3});p.value=n[i],await O.store(D).then(_=>{n[i].push(_.data)}).catch(()=>{var _;m.add({severity:"error",summary:`${(_=b.value)==null?void 0:_.name} bu smenada  mavjud.`,detail:"Bir kishi bir smenada ikki lavozimda ishlay olmaydi!",life:5e3})}).finally(()=>{p.value=null}),b.value=null}},S=(t,n,i)=>{O.destroy(t).then(D=>{n.splice(i,1)})};return G(async()=>{await $(c.transport.id),console.log(g),v.value=c.lavozims.map(t=>(B.forEach(n=>{var D;const i=(D=g.value)==null?void 0:D.filter(l=>l.change_id==n&&l.lavozim_id==t.id&&l.transport_id==c.transport.id);t[n]=[],i==null||i.forEach(l=>{t[n].push(l)})}),t))}),(t,n)=>{const i=ee,D=te;return s(),o("div",Ne,[a("h3",Oe,[E(f(t.transport.garage_number)+" - ",1),a("span",Pe,f(t.list.name),1)]),a("div",qe,[a("div",Me,[I(Ke,{groupLavozims:v.value,list:c.list,onDragstart:j},null,8,["groupLavozims","list"])]),a("div",Ue,[v.value==null?(s(),o(k,{key:0},T(2,l=>I(i,{"border-radius":"12px",height:"208px",width:"100%"})),64)):(s(!0),o(k,{key:1},T(v.value,l=>(s(),o("div",{key:l.id,class:"h-40 border border-gray-200 rounded-xl flex flex-col bg-white"},[a("div",Ge,[a("span",Je,f(l.name),1)]),a("main",He,[(s(!0),o(k,null,T(x(B),u=>(s(),o("div",{onDragover:ce(y=>w(y,l[u]),["prevent"]),onDragleave:n[0]||(n[0]=y=>d.value=null),onDrop:y=>F(y,l,u),class:X([{"bg-surface-50":d.value==l[u]},"basis-0 flex-grow border-l first:border-0 border-surface-100 h-full relative transition-all"])},[a("span",Ye,[p.value==l[u]?(s(),z(i,{key:0,shape:"circle",height:"24px",width:"24px"})):(s(),o("span",We,f(h(u)),1))]),a("div",Xe,[(s(!0),o(k,null,T(l[u],(y,_)=>(s(),z(D,{onRemove:L=>S(y.id,l[u],_),key:y,label:y.employe.name,class:"text-xs! animate-pop-in",removable:!x(r).isAdmin},null,8,["onRemove","label","removable"]))),128))])],42,Qe))),256))])]))),128))])])])}}}),et=de(Ze,[["__scopeId","data-v-b33bfd5f"]]),tt={class:"flex w-full"},st={class:"pt-4"},at={class:"flex items-center gap-2 text-sm text-gray-500 justify-between mb-9"},nt={class:"flex gap-2"},ot={key:0,class:"inline-flex items-center gap-2"},rt={class:"text-gray-700 font-semibold"},it={key:1,class:"inline-flex items-center gap-2"},lt={class:"text-gray-700 font-semibold"},ct={class:"py-2 mb-3"},dt={class:"text-gray-500 text-sm"},ut={class:"text-xl"},pt={class:"min-w-48 relative z-50 the-shadow"},mt={class:"absolute inset-0 overflow-y-auto overflow-x-hidden h-full flex flex-col gap-1 py-10 scroll-left"},ht={class:"font-semibold text-[16px]"},ft={class:"p-8 pt-4 flex-grow bg-white border border-gray-100 rounded-4xl min-h-154 shadow-xs"},gt={key:0,class:"flex items-center justify-center h-full"},vt={key:1,class:"flex items-center justify-center h-full"},yt={key:2},bt=q({__name:"ActiveTransportTab",props:{transport_type:{}},setup(e){const r=e,p=C([]),m=C(null),d=C(null),{execute:c,data:$}=P(O.byTransportChange),g=C(!1),h=ue({smena:null,change:null,groups:null});async function B(S,t){var n;await c((n=m.value)==null?void 0:n.id,S.id),h.smena=t,h.change=S,h.groups=$,g.value=!0}const b=C(0),{execute:v,data:j,isFirstLoading:w}=P($e.index);async function F(S,t){d.value=null,m.value=null,await me(),m.value=S,d.value=t}return G(async()=>{const{data:S}=await ke.byTransportType(r.transport_type.id);await v(),p.value=S;let t=null,n=null;for(const i of S)if(i.transports.length>0){t=i.transports[0],n=i;break}n&&t&&F(t,n)}),(S,t)=>{var D,l;const n=pe,i=ve;return s(),o("section",tt,[I(n,{visible:g.value,"onUpdate:visible":t[0]||(t[0]=u=>g.value=u),modal:"",header:`${(D=m.value)==null?void 0:D.garage_number}  - ${(l=d.value)==null?void 0:l.name}`,style:{width:"25rem"}},{default:N(()=>{var u,y,_,L,J,H;return[a("main",st,[a("aside",at,[a("main",nt,[a("span",null,f(x(M)((u=h.smena)==null?void 0:u.day).month)+" - "+f(x(M)((y=h.smena)==null?void 0:y.day).day),1),a("span",null,f(x(M)((_=h.smena)==null?void 0:_.day).weekday),1)]),((L=h.smena)==null?void 0:L.smena)==1?(s(),o("span",ot,[t[2]||(t[2]=E(" Kunduzgi ")),a("b",rt,f((J=h.change)==null?void 0:J.name),1),t[3]||(t[3]=E(" smena ")),t[4]||(t[4]=a("span",{class:"p-button-icon pi pi-sun text-orange-400"},null,-1))])):(s(),o("span",it,[t[5]||(t[5]=E(" Tungi ")),a("b",lt,f((H=h.change)==null?void 0:H.name),1),t[6]||(t[6]=E(" smena ")),t[7]||(t[7]=a("span",{class:"p-button-icon pi pi-moon !text-sm text-sky-500"},null,-1))]))]),(s(!0),o(k,null,T(h.groups,Q=>(s(),o("div",ct,[a("h3",dt,f(Q.lavozim.name),1),a("div",ut,f(Q.employe.name),1)]))),256))])]}),_:1},8,["visible","header"]),a("nav",pt,[a("main",mt,[(s(!0),o(k,null,T(p.value,u=>(s(),o(k,null,[(s(!0),o(k,null,T(u.transports,y=>{var _;return s(),z(Z,{class:"w-full text-left",direction:"right",onClick:L=>F(y,u),active:((_=m.value)==null?void 0:_.id)==y.id,onVnodeMounted:t[1]||(t[1]=L=>b.value++)},{default:N(()=>[E(f(u.name)+" - ",1),a("span",ht,f(y.garage_number),1)]),_:2},1032,["onClick","active"])}),256))],64))),256))])]),a("aside",ft,[x(w)?(s(),o("main",gt,[I(i)])):b.value==0?(s(),o("main",vt,t[8]||(t[8]=[a("div",{class:"w-120 text-center"},[a("h3",{class:"text-gray-800 text-2xl mb-1 font-semibold"},"Qurilmalar kiritilmagan"),a("p",{class:"text-gray-500"}," Hozirda ushbu transport turiga hech qanday qurilma kiritilmagan. Iltimos, avval transport turlariga mos qurilmalarni qo'shing. ")],-1)]))):(s(),o("main",yt,[d.value&&m.value&&x(j)?(s(),z(et,{key:0,class:"mb-4",changes:x(j),list:d.value,lavozims:r.transport_type.lavozims,transport:m.value},null,8,["changes","list","lavozims","transport"])):A("",!0),a("main",null,[m.value?(s(),z(ye,{key:0,transport:m.value,onSelectSmena:B},null,8,["transport"])):A("",!0)])]))])])}}}),_t={key:0,name:"tabs",class:"flex flex-col p-5"},xt={class:"flex gap-0.5 pl-60 relative z-10 justify-between items-end"},kt={class:"relative"},Vt=q({__name:"OrganizationPage",props:["id"],setup(e){const r=e,p=C(null),m=U(),{execute:d,isLoading:c,data:$}=P(we.transports);return he(()=>r.id,g=>d({id:g})),G(async()=>{var g;m.isAdmin?await d({id:r.id}):await d({id:(g=m.user)==null?void 0:g.organization_id}),$.value&&$.value.transport_types[0]&&(p.value=$.value.transport_types[0].id)}),(g,h)=>{var B,b;return x(c)?A("",!0):(s(),o("section",_t,[a("nav",xt,[a("main",null,[(s(!0),o(k,null,T((B=x($))==null?void 0:B.transport_types,v=>(s(),z(Z,{class:"text-xl!",active:p.value==v.id,onClick:j=>p.value=v.id},{default:N(()=>[E(f(v.name),1)]),_:2},1032,["active","onClick"]))),256))]),I(ge,{id:r.id},null,8,["id"])]),a("main",kt,[(s(!0),o(k,null,T((b=x($))==null?void 0:b.transport_types,v=>(s(),z(fe,{name:"fade",mode:"out-in"},{default:N(()=>[v.id===p.value?(s(),z(bt,{key:v.id,transport_type:v},null,8,["transport_type"])):A("",!0)]),_:2},1024))),256))])]))}}});export{Vt as default};
